# Research: Переключение статуса и SSE

Цель: исправить смену статуса и доставку событий реального времени на фронт.

Наблюдения:
- PATCH `/api/projects/:id/status` менял только `isPublished`, сервис публиковал события только при изменении `status`.
- В контроллере была ручная публикация события — риск дублирования.
- Найдены артефакты компиляции `.js` рядом с `.ts` в `src/server/projects/**` и легаси-контроллеры минимального сервера.

Решение:
- Контроллер теперь нормализует статус, обновляет одновременно `status` и `isPublished`. Публикация событий остаётся в сервисе.
- Удалены `.js` артефакты и легаси `projects-simple.controller.ts` и `projects-minimal.module.ts`.
- Добавлен heartbeat `GET /api/projects/heartbeat` для стабильности соединения.

Проверка:
- e2e: переключение статуса и синхронизация вкладок через SSE и BroadcastChannel.

Долг/следующие шаги:
- Лицензионный аудит зависимостей при добавлении новых (не добавляли).
- Документация модулей и единая точка запуска (pm2/systemd) — запланированы.
