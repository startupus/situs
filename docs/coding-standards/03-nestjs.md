# NestJS (Backend)

Назначение: стандарты модульной архитектуры, DTO, валидации и исключений.

## Чеклист реализации
- [x] Структура модулей, контроллеров, сервисов и сущностей
- [x] DTO и валидация (class-validator, class-transformer)
- [x] Исключения и обработка ошибок (HTTP exeptions)
- [x] Провайдеры, DI и инверсия зависимостей
- [x] Логирование и метрики
- [x] ORM-границы: Prisma/TypeORM на модуль, не смешивать внутри
- [x] Тестирование сервисов и контроллеров

## Архитектура модулей
- По доменам: `src/server/<domain>/*` с файлами `*.module.ts`, `*.controller.ts`, `*.service.ts`, `entities/*`, `dto/*`.
- Контроллер — тонкий слой: маршрутизация, DTO/валидация, коды ответа. Бизнес‑логика — в сервисах.
- Репозитории/доступ к данным инкапсулировать в провайдерах слоя данных.

## DTO и валидация
- DTO в `dto/*.ts`, классы с декораторами `class-validator` и `class-transformer`.
- Глобальные пайпы: `ValidationPipe({ whitelist: true, forbidNonWhitelisted: true, transform: true })`.

## Исключения
- Использовать `HttpException` и производные (`BadRequestException`, `NotFoundException`, `ForbiddenException`, ...).
- Не возвращать «сырые» ошибки. Приводить доменные ошибки к HTTP‑исключениям.

## Провайдеры и DI
- Провайдеры объявлять в модуле, зависимости передавать через конструктор.
- Выносить интерфейсы/контракты в `src/types/*` при многократном использовании.

## Логирование и метрики
- Централизованный логгер и интерсепторы для логирования запросов/исключений.
- Метрики/тайминги для критических путей (при наличии).

## ORM‑границы
- В рамках одного домена придерживаться одного ORM: Prisma или TypeORM. Не смешивать внутри модуля.
- Транзакции — средствами выбранного ORM.

## Тестирование
- Юнит‑тесты сервисов/пайпов/гардов; интеграционные — для контроллеров (запуск в изолированном модуле).
- Инструменты: Vitest; Jest не использовать.

## Документация API
- Использовать Swagger декораторы (`@ApiTags`, `@ApiOperation`, `@ApiProperty`) для публичных контрактов.

## Навигация
Назад: `./README.md`