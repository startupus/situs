# Правила и стандарты работы (rules.md)

## Основные пользовательские правила (User Rules)

1. **Jest не использовать**
2. Действуй как архитектор и ведущий разработчик, самостоятельно принимая решения инфраструктурного характера, выполняя
   задачу итерациями и автоматически до её завершения, в конце обязательно тесты и документирование.
3. Комментируй код, который ты пишешь, и в каждой папке раздела держи свой README-файл, который будет рассказывать, что в
   этом разделе есть и что за что отвечает. Общую сборку всех данных можно сложить в корневом README.md головной папки
   проекта со ссылками на уточняющие файлы внутри папок.
4. Сверяйся с логикой в документации, если видишь расхождение с текущими задачами — спрашивай пользователя, что делать
   (доработать документацию или скорректировать логику работы над проектом и свои приоритеты).
5. Заведи файл info, который описывает бизнесовый взгляд на проект, сохраняй туда данные, которые говорит пользователь,
   если они имеют значение как общее описание проекта.
6. Создавая код проекта или API, веди документацию в отдельном файле, который поможет разобраться тебе же или другим
   разработчикам, как всё работает.
7. Для выполнения больших задач создавай файл с чеклистом задачи перед началом исполнения, по ходу итераций вписывай
   изменения в этот файл, расширяй список задач, если потребуется, и отмечай, что сделано. В такие задачи обязательно
   включать создание специализированных автотестов.
8. При написании текстов писать ближе к сути, для убедительности использовать факты, а не оценочные суждения. Тон —
   дружелюбно-сдержанный. Компания с открытым лицом, пишет с уважением и любовью к клиенту.
9. Завершай этап редактирования кода запуском автотестов.
10. Создавая новый функционал, создавай автотесты для тестирования его работоспособности, а удаляя функционал — удаляй и
    автотесты, которые его тестировали. Итог изменений заноси в README.md.
11. Не требуй от пользователя то, что можешь сделать сам, запускай обработку следующими шагами автоматически.
12. Всегда пиши на русском языке.

---

## Стандарты Hubus (выдержка)

- Все публичные методы API каждого сервиса должны быть описаны в API_DOCUMENTATION.md.
- После успешного прохождения автотестов все изменения должны автоматически коммититься и пушиться в репозиторий
  (CI/CD-first).
- В каждом сервисе и в корне должны быть README.md, TESTING.md, TODO.md, INFO.md.
- Для e2e/unit тестов использовать моки, централизованные типы, строгую типизацию, покрытие edge-cases.
- После изменения схемы Prisma всегда выполнять npx prisma generate.
- Вся документация поддерживается в актуальном состоянии, структура заголовков соответствует markdown-стандартам.
- Все бизнес-правила и best practice фиксируются в документации и мемори.

---

- \*Последнее обновление:\*\* 01.07.2025

## Дополнительные правила для соответствия mandatory-behavioral-firewall

1. **Обязательный протокол исследования перед изменениями**
   Перед любым изменением кода или архитектуры необходимо провести исследование (research protocol):
   – Анализировать существующие решения, стандарты и best practice.
   – Документировать выводы исследования в отдельном артефакте (например, research/RESEARCH_STEP.md).

1. **Атомарное разложение задач**
   Любая сложная задача должна быть разбита на атомарные подзадачи с чёткими критериями завершения.
   – Для каждой подзадачи фиксируется expected result и критерии проверки.

1. **Контроль следования инструкциям**
   Все шаги, описанные в пользовательских и проектных инструкциях, должны быть выполнены до перехода к следующему действию.
   – Если инструкция не выполнена — дальнейшие действия блокируются.

1. **Контролируемое завершение задачи**
   Ассистент не завершает задачу самостоятельно — только после подтверждения пользователя о тестировании и
   работоспособности.

1. **Верификация новых правил и стандартов**
   Любое новое правило или стандарт должно быть интегрировано в протоколы (precise_triggers) и зафиксировано в документации.

1. **Лицензионный аудит зависимостей**
   При добавлении новых зависимостей проводится аудит лицензий (license audit) и фиксируется результат.

1. **Защищённые зоны (protected_zones)**
   – Эталонный код и критические документы доступны только для чтения.
   – Любые изменения в этих зонах требуют отдельного согласования.

1. **Интеграция с системами поиска знаний (например, Context7)**
   Для поиска документации и best practice отдавать приоритет интегрированным системам (Context7), а не только web search.

---

- \*Подробнее:\*\*
  [startupus/mandatory-behavioral-firewall](<https://github.com/startupus/mandatory-behavioral-firewall)>
