# –û—Ç—á–µ—Ç: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–æ–µ–∫—Ç–æ–≤

## üö® –ü—Ä–æ–±–ª–µ–º–∞
–û—à–∏–±–∫–∞ –≤ –±—Ä–∞—É–∑–µ—Ä–µ: `Cannot read properties of undefined (reading 'map')` –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –ø—Ä–æ–µ–∫—Ç–æ–≤.

## üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

### 1. –ê–Ω–∞–ª–∏–∑ –æ—à–∏–±–∫–∏
- **–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ**: `src/api/services/sites.api.ts:196`
- **–°—Ç—Ä–æ–∫–∞**: `project.pages.map(page => this.projectPageToPage(page))`
- **–ü—Ä–∏—á–∏–Ω–∞**: `project.pages` –±—ã–ª–æ `undefined`

### 2. –ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö
- **Backend API**: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—Ä–æ–µ–∫—Ç—ã —Å –ø–æ–ª–µ–º `products`, –∞ –Ω–µ `pages`
- **Frontend —Ç–∏–ø**: –û–∂–∏–¥–∞–ª –ø–æ–ª–µ `pages` –≤ —Ç–∏–ø–µ `Project`
- **–ù–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ**: –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏–∑–º–µ–Ω–∏–ª–∞—Å—å, –Ω–æ frontend –Ω–µ –æ–±–Ω–æ–≤–∏–ª—Å—è

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

### 1. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ Project
```typescript
// src/types/project.ts
export interface Project {
  // ...
  pages?: ProjectPage[]; // –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
  products: ProjectProduct[]; // –ü—Ä–æ–¥—É–∫—Ç—ã –ø—Ä–æ–µ–∫—Ç–∞
  // ...
}
```

### 2. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ ProjectProduct
```typescript
export interface ProjectProduct {
  id: string;
  name: string;
  type: 'WEBSITE' | 'STORE' | 'BLOG' | 'APP' | 'LANDING';
  status: 'DRAFT' | 'PUBLISHED' | 'ARCHIVED';
  description?: string;
  settings?: {
    theme: 'light' | 'dark' | 'auto';
    primaryColor?: string;
    favicon?: string;
    logo?: string;
    domain?: string;
  };
  pages?: ProjectPage[];
  analytics?: {
    visitors: number;
    pageViews: number;
    conversionRate: number;
    revenue: number;
  };
  createdAt: Date;
  updatedAt: Date;
}
```

### 3. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ sites.api.ts
```typescript
private projectToSite(project: Project): Site {
  // –ü–æ–ª—É—á–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∏–∑ –ø–µ—Ä–≤–æ–≥–æ –ø—Ä–æ–¥—É–∫—Ç–∞ –ø—Ä–æ–µ–∫—Ç–∞
  let pages: ProjectPage[] = [];
  if (project.products && project.products.length > 0) {
    const firstProduct = project.products[0];
    if (firstProduct.pages) {
      pages = firstProduct.pages;
    }
  }
  
  // Fallback –Ω–∞ —Å—Ç–∞—Ä—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –ø—Ä–æ–µ–∫—Ç–∞ –µ—Å–ª–∏ –µ—Å—Ç—å
  if (pages.length === 0 && project.pages) {
    pages = project.pages;
  }

  return {
    // ...
    pages: pages.map(page => this.projectPageToPage(page)),
    // ...
  };
}
```

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

### ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ
- **–û—à–∏–±–∫–∞ map**: –£—Å—Ç—Ä–∞–Ω–µ–Ω–∞ –æ—à–∏–±–∫–∞ `Cannot read properties of undefined (reading 'map')`
- **–¢–∏–ø–∏–∑–∞—Ü–∏—è**: –û–±–Ω–æ–≤–ª–µ–Ω—ã —Ç–∏–ø—ã –¥–ª—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –Ω–æ–≤–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ
- **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å**: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –æ–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å–æ —Å—Ç–∞—Ä—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
- **–ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ–µ–∫—Ç–æ–≤**: –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø—Ä–æ–µ–∫—Ç–æ–≤ —Ç–µ–ø–µ—Ä—å –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

### ‚úÖ –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ
- **Backend API**: `/api/projects` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- **Frontend**: –ü—Ä–æ–µ–∫—Ç—ã –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- **–ö–æ–Ω—Å–æ–ª—å**: –ù–µ—Ç –æ—à–∏–±–æ–∫ –≤ –±—Ä–∞—É–∑–µ—Ä–µ
- **–ù–∞–≤–∏–≥–∞—Ü–∏—è**: –†–∞–±–æ—Ç–∞–µ—Ç –ø–µ—Ä–µ—Ö–æ–¥ –º–µ–∂–¥—É —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º–∏

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö
```
Project (–ü—Ä–æ–µ–∫—Ç)
‚îú‚îÄ‚îÄ id, name, description
‚îú‚îÄ‚îÄ settings (–Ω–∞—Å—Ç—Ä–æ–π–∫–∏)
‚îî‚îÄ‚îÄ products[] (–ü—Ä–æ–¥—É–∫—Ç—ã)
    ‚îú‚îÄ‚îÄ id, name, type, status
    ‚îú‚îÄ‚îÄ settings (–Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–¥—É–∫—Ç–∞)
    ‚îú‚îÄ‚îÄ pages[] (–°—Ç—Ä–∞–Ω–∏—Ü—ã –ø—Ä–æ–¥—É–∫—Ç–∞)
    ‚îî‚îÄ‚îÄ analytics (–ê–Ω–∞–ª–∏—Ç–∏–∫–∞)
```

### API Endpoints
- `GET /api/projects` - —Å–ø–∏—Å–æ–∫ –ø—Ä–æ–µ–∫—Ç–æ–≤
- `GET /api/projects/:id/products` - –ø—Ä–æ–¥—É–∫—Ç—ã –ø—Ä–æ–µ–∫—Ç–∞
- `GET /api/products` - –≤—Å–µ –ø—Ä–æ–¥—É–∫—Ç—ã

### –¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö
- **Project**: –û—Å–Ω–æ–≤–Ω–∞—è —Å—É—â–Ω–æ—Å—Ç—å –ø—Ä–æ–µ–∫—Ç–∞
- **ProjectProduct**: –ü—Ä–æ–¥—É–∫—Ç –≤–Ω—É—Ç—Ä–∏ –ø—Ä–æ–µ–∫—Ç–∞
- **ProjectPage**: –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø—Ä–æ–¥—É–∫—Ç–∞
- **Site**: –ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ –¥–ª—è frontend

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### 1. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –ø—Ä–æ–¥—É–∫—Ç–æ–≤
- –û–±–Ω–æ–≤–∏—Ç—å `ProjectsList` –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø—Ä–æ–¥—É–∫—Ç–æ–≤
- –î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç `ProjectProducts`
- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–¥—É–∫—Ç–æ–≤

### 2. –£–ª—É—á—à–µ–Ω–∏–µ UX
- –ü–æ–∫–∞–∑–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –≤ –ø—Ä–æ–µ–∫—Ç–µ
- –î–æ–±–∞–≤–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é –ø–æ —Ç–∏–ø–∞–º –ø—Ä–æ–¥—É–∫—Ç–æ–≤
- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–æ–∏—Å–∫ –ø–æ –ø—Ä–æ–¥—É–∫—Ç–∞–º

### 3. –ê–Ω–∞–ª–∏—Ç–∏–∫–∞
- –û—Ç–æ–±—Ä–∞–∑–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–¥—É–∫—Ç–æ–≤
- –î–æ–±–∞–≤–∏—Ç—å –≥—Ä–∞—Ñ–∏–∫–∏ –∏ –¥–∏–∞–≥—Ä–∞–º–º—ã
- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —ç–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö

## üéâ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–æ–µ–∫—Ç–æ–≤ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞:
- ‚úÖ –£—Å—Ç—Ä–∞–Ω–µ–Ω–∞ –æ—à–∏–±–∫–∞ `map` –Ω–∞ `undefined`
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∞ —Ç–∏–ø–∏–∑–∞—Ü–∏—è –¥–ª—è –Ω–æ–≤–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –æ–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å
- ‚úÖ –ü—Ä–æ–µ–∫—Ç—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

**–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –¥–∞–ª—å–Ω–µ–π—à–µ–º—É —Ä–∞–∑–≤–∏—Ç–∏—é —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π –ø—Ä–æ–¥—É–∫—Ç–æ–≤!**

---
**–î–∞—Ç–∞**: –ê–≤–≥—É—Å—Ç 2024  
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ  
**–û—à–∏–±–∫–∞**: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞
