{"body":{"messages":[{"content":"e2e test","role":"user"}],"model":"openrouter-llm"},"level":"info","message":"POST /api/proxy/chat/completions","timestamp":"2025-06-27T20:35:12.819Z"}
{"err":{},"level":"error","message":"Unhandled error","method":"POST","timestamp":"2025-06-27T20:35:12.824Z","url":"/api/proxy/chat/completions"}
{"body":{"messages":[{"content":"e2e test","role":"user"}],"model":"openrouter-llm","provider":"openrouter"},"level":"info","message":"POST /api/proxy/chat/completions","timestamp":"2025-06-27T20:35:12.839Z"}
{"err":{},"level":"error","message":"Unhandled error","method":"POST","timestamp":"2025-06-27T20:35:12.841Z","url":"/api/proxy/chat/completions"}
{"body":{"messages":[{"content":"e2e test","role":"user"}],"model":"gpt-3.5-turbo","provider":"openai"},"level":"info","message":"POST /api/proxy/chat/completions","timestamp":"2025-06-27T20:35:12.850Z"}
{"level":"info","message":"Proxy response","result":{"_attempts":[{"provider":"openai","response":{"choices":[{"finish_reason":"stop","index":0,"message":{"content":"Это mock-ответ от OpenAIAdapter.","role":"assistant"}}],"created":1751056512,"id":"chatcmpl-mock123","model":"gpt-3.5-turbo","object":"chat.completion","usage":{"completion_tokens":7,"prompt_tokens":5,"total_tokens":12}},"success":true}],"choices":[{"finish_reason":"stop","index":0,"message":{"content":"Это mock-ответ от OpenAIAdapter.","role":"assistant"}}],"created":1751056512,"id":"chatcmpl-mock123","model":"gpt-3.5-turbo","object":"chat.completion","usage":{"completion_tokens":7,"prompt_tokens":5,"total_tokens":12}},"timestamp":"2025-06-27T20:35:12.852Z"}
{"body":{"messages":[{"content":"e2e test","role":"user"}]},"level":"info","message":"POST /api/proxy/chat/completions","timestamp":"2025-06-27T20:35:12.860Z"}
{"body":{"messages":[{"content":"e2e test","role":"user"}]},"error":{"issues":[{"code":"invalid_type","expected":"string","message":"Required","path":["model"],"received":"undefined"}],"name":"ZodError"},"level":"warn","message":"Validation error","timestamp":"2025-06-27T20:35:12.862Z"}
{"body":{"model":"openrouter-llm"},"level":"info","message":"POST /api/proxy/chat/completions","timestamp":"2025-06-27T20:35:12.871Z"}
{"body":{"model":"openrouter-llm"},"error":{"issues":[{"code":"invalid_type","expected":"array","message":"Required","path":["messages"],"received":"undefined"}],"name":"ZodError"},"level":"warn","message":"Validation error","timestamp":"2025-06-27T20:35:12.874Z"}
{"body":{"messages":[{"content":"hi","role":"user"}],"model":"gpt-3.5-turbo","provider":"openai"},"level":"info","message":"POST /api/proxy/chat/completions","timestamp":"2025-06-27T20:35:12.887Z"}
{"level":"info","message":"Proxy response","result":{"_attempts":[{"provider":"openai","response":{"choices":[{"finish_reason":"stop","index":0,"message":{"content":"Это mock-ответ от OpenAIAdapter.","role":"assistant"}}],"created":1751056512,"id":"chatcmpl-mock123","model":"gpt-3.5-turbo","object":"chat.completion","usage":{"completion_tokens":7,"prompt_tokens":5,"total_tokens":12}},"success":true}],"choices":[{"finish_reason":"stop","index":0,"message":{"content":"Это mock-ответ от OpenAIAdapter.","role":"assistant"}}],"created":1751056512,"id":"chatcmpl-mock123","model":"gpt-3.5-turbo","object":"chat.completion","usage":{"completion_tokens":7,"prompt_tokens":5,"total_tokens":12}},"timestamp":"2025-06-27T20:35:12.889Z"}
{"body":{"messages":[{"content":"hi","role":"user"}],"model":"gpt-3.5-turbo","provider":"openai"},"level":"info","message":"POST /api/proxy/chat/completions","timestamp":"2025-06-27T20:35:12.895Z"}
{"level":"info","message":"Proxy response","result":{"_attempts":[{"provider":"openai","response":{"choices":[{"finish_reason":"stop","index":0,"message":{"content":"Это mock-ответ от OpenAIAdapter.","role":"assistant"}}],"created":1751056512,"id":"chatcmpl-mock123","model":"gpt-3.5-turbo","object":"chat.completion","usage":{"completion_tokens":7,"prompt_tokens":5,"total_tokens":12}},"success":true}],"choices":[{"finish_reason":"stop","index":0,"message":{"content":"Это mock-ответ от OpenAIAdapter.","role":"assistant"}}],"created":1751056512,"id":"chatcmpl-mock123","model":"gpt-3.5-turbo","object":"chat.completion","usage":{"completion_tokens":7,"prompt_tokens":5,"total_tokens":12}},"timestamp":"2025-06-27T20:35:12.897Z"}
{"body":{"messages":[{"content":"hi","role":"user"}],"model":"gpt-3.5-turbo","provider":"openai"},"level":"info","message":"POST /api/proxy/chat/completions","timestamp":"2025-06-27T20:35:12.902Z"}
{"level":"info","message":"Proxy response","result":{"_attempts":[{"provider":"openai","response":{"choices":[{"finish_reason":"stop","index":0,"message":{"content":"Это mock-ответ от OpenAIAdapter.","role":"assistant"}}],"created":1751056512,"id":"chatcmpl-mock123","model":"gpt-3.5-turbo","object":"chat.completion","usage":{"completion_tokens":7,"prompt_tokens":5,"total_tokens":12}},"success":true}],"choices":[{"finish_reason":"stop","index":0,"message":{"content":"Это mock-ответ от OpenAIAdapter.","role":"assistant"}}],"created":1751056512,"id":"chatcmpl-mock123","model":"gpt-3.5-turbo","object":"chat.completion","usage":{"completion_tokens":7,"prompt_tokens":5,"total_tokens":12}},"timestamp":"2025-06-27T20:35:12.904Z"}
{"body":{"messages":[{"content":"hi","role":"user"}],"model":"gpt-3.5-turbo","provider":"openai"},"level":"info","message":"POST /api/proxy/chat/completions","timestamp":"2025-06-27T20:35:12.910Z"}
{"level":"info","message":"Proxy response","result":{"_attempts":[{"provider":"openai","response":{"choices":[{"finish_reason":"stop","index":0,"message":{"content":"Это mock-ответ от OpenAIAdapter.","role":"assistant"}}],"created":1751056512,"id":"chatcmpl-mock123","model":"gpt-3.5-turbo","object":"chat.completion","usage":{"completion_tokens":7,"prompt_tokens":5,"total_tokens":12}},"success":true}],"choices":[{"finish_reason":"stop","index":0,"message":{"content":"Это mock-ответ от OpenAIAdapter.","role":"assistant"}}],"created":1751056512,"id":"chatcmpl-mock123","model":"gpt-3.5-turbo","object":"chat.completion","usage":{"completion_tokens":7,"prompt_tokens":5,"total_tokens":12}},"timestamp":"2025-06-27T20:35:12.911Z"}
{"body":{"messages":[{"content":"hi","role":"user"}],"model":"gpt-3.5-turbo","provider":"openai"},"level":"info","message":"POST /api/proxy/chat/completions","timestamp":"2025-06-27T20:35:12.917Z"}
{"level":"info","message":"Proxy response","result":{"_attempts":[{"provider":"openai","response":{"choices":[{"finish_reason":"stop","index":0,"message":{"content":"Это mock-ответ от OpenAIAdapter.","role":"assistant"}}],"created":1751056512,"id":"chatcmpl-mock123","model":"gpt-3.5-turbo","object":"chat.completion","usage":{"completion_tokens":7,"prompt_tokens":5,"total_tokens":12}},"success":true}],"choices":[{"finish_reason":"stop","index":0,"message":{"content":"Это mock-ответ от OpenAIAdapter.","role":"assistant"}}],"created":1751056512,"id":"chatcmpl-mock123","model":"gpt-3.5-turbo","object":"chat.completion","usage":{"completion_tokens":7,"prompt_tokens":5,"total_tokens":12}},"timestamp":"2025-06-27T20:35:12.919Z"}
{"body":{"messages":[{"content":"fallback test","role":"user"}],"model":"gpt-3.5-turbo","provider":"openai"},"level":"info","message":"POST /api/proxy/chat/completions","timestamp":"2025-06-27T20:35:12.930Z"}
{"level":"info","message":"Proxy response","result":{"_attempts":[{"error":"Mocked OpenAI failure","provider":"openai","success":false},{"provider":"openrouter","response":{"choices":[{"finish_reason":"stop","index":0,"message":{"content":"Это mock-ответ от OpenRouterAdapter.","role":"assistant"}}],"created":1751056512,"id":"orcmpl-mock789","model":"gpt-3.5-turbo","object":"chat.completion","usage":{"completion_tokens":5,"prompt_tokens":3,"total_tokens":8}},"success":true}],"choices":[{"finish_reason":"stop","index":0,"message":{"content":"Это mock-ответ от OpenRouterAdapter.","role":"assistant"}}],"created":1751056512,"id":"orcmpl-mock789","model":"gpt-3.5-turbo","object":"chat.completion","usage":{"completion_tokens":5,"prompt_tokens":3,"total_tokens":8}},"timestamp":"2025-06-27T20:35:12.932Z"}
{"body":{"messages":[{"content":"e2e test","role":"user"}],"model":"openrouter-llm"},"level":"info","message":"POST /api/proxy/chat/completions","timestamp":"2025-06-27T20:37:08.660Z"}
{"err":{},"level":"error","message":"Unhandled error","method":"POST","timestamp":"2025-06-27T20:37:08.664Z","url":"/api/proxy/chat/completions"}
{"body":{"messages":[{"content":"e2e test","role":"user"}],"model":"openrouter-llm","provider":"openrouter"},"level":"info","message":"POST /api/proxy/chat/completions","timestamp":"2025-06-27T20:37:08.680Z"}
{"err":{},"level":"error","message":"Unhandled error","method":"POST","timestamp":"2025-06-27T20:37:08.682Z","url":"/api/proxy/chat/completions"}
{"body":{"messages":[{"content":"e2e test","role":"user"}],"model":"gpt-3.5-turbo","provider":"openai"},"level":"info","message":"POST /api/proxy/chat/completions","timestamp":"2025-06-27T20:37:08.690Z"}
{"level":"info","message":"Proxy response","result":{"_attempts":[{"provider":"openai","response":{"choices":[{"finish_reason":"stop","index":0,"message":{"content":"Это mock-ответ от OpenAIAdapter.","role":"assistant"}}],"created":1751056628,"id":"chatcmpl-mock123","model":"gpt-3.5-turbo","object":"chat.completion","usage":{"completion_tokens":7,"prompt_tokens":5,"total_tokens":12}},"success":true}],"choices":[{"finish_reason":"stop","index":0,"message":{"content":"Это mock-ответ от OpenAIAdapter.","role":"assistant"}}],"created":1751056628,"id":"chatcmpl-mock123","model":"gpt-3.5-turbo","object":"chat.completion","usage":{"completion_tokens":7,"prompt_tokens":5,"total_tokens":12}},"timestamp":"2025-06-27T20:37:08.693Z"}
{"body":{"messages":[{"content":"e2e test","role":"user"}]},"level":"info","message":"POST /api/proxy/chat/completions","timestamp":"2025-06-27T20:37:08.698Z"}
{"body":{"messages":[{"content":"e2e test","role":"user"}]},"error":{"issues":[{"code":"invalid_type","expected":"string","message":"Required","path":["model"],"received":"undefined"}],"name":"ZodError"},"level":"warn","message":"Validation error","timestamp":"2025-06-27T20:37:08.701Z"}
{"body":{"model":"openrouter-llm"},"level":"info","message":"POST /api/proxy/chat/completions","timestamp":"2025-06-27T20:37:08.707Z"}
{"body":{"model":"openrouter-llm"},"error":{"issues":[{"code":"invalid_type","expected":"array","message":"Required","path":["messages"],"received":"undefined"}],"name":"ZodError"},"level":"warn","message":"Validation error","timestamp":"2025-06-27T20:37:08.709Z"}
{"body":{"messages":[{"content":"hi","role":"user"}],"model":"gpt-3.5-turbo","provider":"openai"},"level":"info","message":"POST /api/proxy/chat/completions","timestamp":"2025-06-27T20:37:08.722Z"}
{"level":"info","message":"Proxy response","result":{"_attempts":[{"provider":"openai","response":{"choices":[{"finish_reason":"stop","index":0,"message":{"content":"Это mock-ответ от OpenAIAdapter.","role":"assistant"}}],"created":1751056628,"id":"chatcmpl-mock123","model":"gpt-3.5-turbo","object":"chat.completion","usage":{"completion_tokens":7,"prompt_tokens":5,"total_tokens":12}},"success":true}],"choices":[{"finish_reason":"stop","index":0,"message":{"content":"Это mock-ответ от OpenAIAdapter.","role":"assistant"}}],"created":1751056628,"id":"chatcmpl-mock123","model":"gpt-3.5-turbo","object":"chat.completion","usage":{"completion_tokens":7,"prompt_tokens":5,"total_tokens":12}},"timestamp":"2025-06-27T20:37:08.724Z"}
{"body":{"messages":[{"content":"hi","role":"user"}],"model":"gpt-3.5-turbo","provider":"openai"},"level":"info","message":"POST /api/proxy/chat/completions","timestamp":"2025-06-27T20:37:08.729Z"}
{"level":"info","message":"Proxy response","result":{"_attempts":[{"provider":"openai","response":{"choices":[{"finish_reason":"stop","index":0,"message":{"content":"Это mock-ответ от OpenAIAdapter.","role":"assistant"}}],"created":1751056628,"id":"chatcmpl-mock123","model":"gpt-3.5-turbo","object":"chat.completion","usage":{"completion_tokens":7,"prompt_tokens":5,"total_tokens":12}},"success":true}],"choices":[{"finish_reason":"stop","index":0,"message":{"content":"Это mock-ответ от OpenAIAdapter.","role":"assistant"}}],"created":1751056628,"id":"chatcmpl-mock123","model":"gpt-3.5-turbo","object":"chat.completion","usage":{"completion_tokens":7,"prompt_tokens":5,"total_tokens":12}},"timestamp":"2025-06-27T20:37:08.732Z"}
{"body":{"messages":[{"content":"hi","role":"user"}],"model":"gpt-3.5-turbo","provider":"openai"},"level":"info","message":"POST /api/proxy/chat/completions","timestamp":"2025-06-27T20:37:08.738Z"}
{"level":"info","message":"Proxy response","result":{"_attempts":[{"provider":"openai","response":{"choices":[{"finish_reason":"stop","index":0,"message":{"content":"Это mock-ответ от OpenAIAdapter.","role":"assistant"}}],"created":1751056628,"id":"chatcmpl-mock123","model":"gpt-3.5-turbo","object":"chat.completion","usage":{"completion_tokens":7,"prompt_tokens":5,"total_tokens":12}},"success":true}],"choices":[{"finish_reason":"stop","index":0,"message":{"content":"Это mock-ответ от OpenAIAdapter.","role":"assistant"}}],"created":1751056628,"id":"chatcmpl-mock123","model":"gpt-3.5-turbo","object":"chat.completion","usage":{"completion_tokens":7,"prompt_tokens":5,"total_tokens":12}},"timestamp":"2025-06-27T20:37:08.740Z"}
{"body":{"messages":[{"content":"hi","role":"user"}],"model":"gpt-3.5-turbo","provider":"openai"},"level":"info","message":"POST /api/proxy/chat/completions","timestamp":"2025-06-27T20:37:08.745Z"}
{"level":"info","message":"Proxy response","result":{"_attempts":[{"provider":"openai","response":{"choices":[{"finish_reason":"stop","index":0,"message":{"content":"Это mock-ответ от OpenAIAdapter.","role":"assistant"}}],"created":1751056628,"id":"chatcmpl-mock123","model":"gpt-3.5-turbo","object":"chat.completion","usage":{"completion_tokens":7,"prompt_tokens":5,"total_tokens":12}},"success":true}],"choices":[{"finish_reason":"stop","index":0,"message":{"content":"Это mock-ответ от OpenAIAdapter.","role":"assistant"}}],"created":1751056628,"id":"chatcmpl-mock123","model":"gpt-3.5-turbo","object":"chat.completion","usage":{"completion_tokens":7,"prompt_tokens":5,"total_tokens":12}},"timestamp":"2025-06-27T20:37:08.747Z"}
{"body":{"messages":[{"content":"hi","role":"user"}],"model":"gpt-3.5-turbo","provider":"openai"},"level":"info","message":"POST /api/proxy/chat/completions","timestamp":"2025-06-27T20:37:08.761Z"}
{"level":"info","message":"Proxy response","result":{"_attempts":[{"provider":"openai","response":{"choices":[{"finish_reason":"stop","index":0,"message":{"content":"Это mock-ответ от OpenAIAdapter.","role":"assistant"}}],"created":1751056628,"id":"chatcmpl-mock123","model":"gpt-3.5-turbo","object":"chat.completion","usage":{"completion_tokens":7,"prompt_tokens":5,"total_tokens":12}},"success":true}],"choices":[{"finish_reason":"stop","index":0,"message":{"content":"Это mock-ответ от OpenAIAdapter.","role":"assistant"}}],"created":1751056628,"id":"chatcmpl-mock123","model":"gpt-3.5-turbo","object":"chat.completion","usage":{"completion_tokens":7,"prompt_tokens":5,"total_tokens":12}},"timestamp":"2025-06-27T20:37:08.763Z"}
{"body":{"messages":[{"content":"fallback test","role":"user"}],"model":"gpt-3.5-turbo","provider":"openai"},"level":"info","message":"POST /api/proxy/chat/completions","timestamp":"2025-06-27T20:37:08.774Z"}
{"level":"info","message":"Proxy response","result":{"_attempts":[{"error":"Mocked OpenAI failure","provider":"openai","success":false},{"provider":"openrouter","response":{"choices":[{"finish_reason":"stop","index":0,"message":{"content":"Это mock-ответ от OpenRouterAdapter.","role":"assistant"}}],"created":1751056628,"id":"orcmpl-mock789","model":"gpt-3.5-turbo","object":"chat.completion","usage":{"completion_tokens":5,"prompt_tokens":3,"total_tokens":8}},"success":true}],"choices":[{"finish_reason":"stop","index":0,"message":{"content":"Это mock-ответ от OpenRouterAdapter.","role":"assistant"}}],"created":1751056628,"id":"orcmpl-mock789","model":"gpt-3.5-turbo","object":"chat.completion","usage":{"completion_tokens":5,"prompt_tokens":3,"total_tokens":8}},"timestamp":"2025-06-27T20:37:08.776Z"}
{"body":{"messages":[{"content":"e2e test","role":"user"}],"model":"openrouter-llm"},"level":"info","message":"POST /api/proxy/chat/completions","timestamp":"2025-06-27T20:41:44.548Z"}
{"err":{},"level":"error","message":"Unhandled error","method":"POST","timestamp":"2025-06-27T20:41:44.552Z","url":"/api/proxy/chat/completions"}
{"body":{"messages":[{"content":"e2e test","role":"user"}],"model":"openrouter-llm","provider":"openrouter"},"level":"info","message":"POST /api/proxy/chat/completions","timestamp":"2025-06-27T20:41:44.567Z"}
{"err":{},"level":"error","message":"Unhandled error","method":"POST","timestamp":"2025-06-27T20:41:44.569Z","url":"/api/proxy/chat/completions"}
{"body":{"messages":[{"content":"e2e test","role":"user"}],"model":"gpt-3.5-turbo","provider":"openai"},"level":"info","message":"POST /api/proxy/chat/completions","timestamp":"2025-06-27T20:41:44.579Z"}
{"level":"info","message":"Proxy response","result":{"_attempts":[{"provider":"openai","response":{"choices":[{"finish_reason":"stop","index":0,"message":{"content":"Это mock-ответ от OpenAIAdapter.","role":"assistant"}}],"created":1751056904,"id":"chatcmpl-mock123","model":"gpt-3.5-turbo","object":"chat.completion","usage":{"completion_tokens":7,"prompt_tokens":5,"total_tokens":12}},"success":true}],"choices":[{"finish_reason":"stop","index":0,"message":{"content":"Это mock-ответ от OpenAIAdapter.","role":"assistant"}}],"created":1751056904,"id":"chatcmpl-mock123","model":"gpt-3.5-turbo","object":"chat.completion","usage":{"completion_tokens":7,"prompt_tokens":5,"total_tokens":12}},"timestamp":"2025-06-27T20:41:44.581Z"}
{"body":{"messages":[{"content":"e2e test","role":"user"}]},"level":"info","message":"POST /api/proxy/chat/completions","timestamp":"2025-06-27T20:41:44.594Z"}
{"body":{"messages":[{"content":"e2e test","role":"user"}]},"error":{"issues":[{"code":"invalid_type","expected":"string","message":"Required","path":["model"],"received":"undefined"}],"name":"ZodError"},"level":"warn","message":"Validation error","timestamp":"2025-06-27T20:41:44.596Z"}
{"body":{"model":"openrouter-llm"},"level":"info","message":"POST /api/proxy/chat/completions","timestamp":"2025-06-27T20:41:44.602Z"}
{"body":{"model":"openrouter-llm"},"error":{"issues":[{"code":"invalid_type","expected":"array","message":"Required","path":["messages"],"received":"undefined"}],"name":"ZodError"},"level":"warn","message":"Validation error","timestamp":"2025-06-27T20:41:44.604Z"}
{"body":{"messages":[{"content":"e2e test","role":"user"}],"model":"openrouter-llm","provider":"unknown"},"level":"info","message":"POST /api/proxy/chat/completions","timestamp":"2025-06-27T20:41:44.612Z"}
{"body":{"messages":[{"content":"e2e test","role":"user"}],"model":"openrouter-llm","provider":"unknown"},"error":{"issues":[{"code":"invalid_enum_value","message":"Invalid enum value. Expected 'openrouter' | 'openai', received 'unknown'","options":["openrouter","openai"],"path":["provider"],"received":"unknown"}],"name":"ZodError"},"level":"warn","message":"Validation error","timestamp":"2025-06-27T20:41:44.615Z"}
{"body":{"messages":[{"content":"hi","role":"user"}],"model":"gpt-3.5-turbo","provider":"openai"},"level":"info","message":"POST /api/proxy/chat/completions","timestamp":"2025-06-27T20:41:44.624Z"}
{"level":"info","message":"Proxy response","result":{"_attempts":[{"provider":"openai","response":{"choices":[{"finish_reason":"stop","index":0,"message":{"content":"Это mock-ответ от OpenAIAdapter.","role":"assistant"}}],"created":1751056904,"id":"chatcmpl-mock123","model":"gpt-3.5-turbo","object":"chat.completion","usage":{"completion_tokens":7,"prompt_tokens":5,"total_tokens":12}},"success":true}],"choices":[{"finish_reason":"stop","index":0,"message":{"content":"Это mock-ответ от OpenAIAdapter.","role":"assistant"}}],"created":1751056904,"id":"chatcmpl-mock123","model":"gpt-3.5-turbo","object":"chat.completion","usage":{"completion_tokens":7,"prompt_tokens":5,"total_tokens":12}},"timestamp":"2025-06-27T20:41:44.626Z"}
{"body":{"messages":[{"content":"hi","role":"user"}],"model":"gpt-3.5-turbo","provider":"openai"},"level":"info","message":"POST /api/proxy/chat/completions","timestamp":"2025-06-27T20:41:44.631Z"}
{"level":"info","message":"Proxy response","result":{"_attempts":[{"provider":"openai","response":{"choices":[{"finish_reason":"stop","index":0,"message":{"content":"Это mock-ответ от OpenAIAdapter.","role":"assistant"}}],"created":1751056904,"id":"chatcmpl-mock123","model":"gpt-3.5-turbo","object":"chat.completion","usage":{"completion_tokens":7,"prompt_tokens":5,"total_tokens":12}},"success":true}],"choices":[{"finish_reason":"stop","index":0,"message":{"content":"Это mock-ответ от OpenAIAdapter.","role":"assistant"}}],"created":1751056904,"id":"chatcmpl-mock123","model":"gpt-3.5-turbo","object":"chat.completion","usage":{"completion_tokens":7,"prompt_tokens":5,"total_tokens":12}},"timestamp":"2025-06-27T20:41:44.633Z"}
{"body":{"messages":[{"content":"hi","role":"user"}],"model":"gpt-3.5-turbo","provider":"openai"},"level":"info","message":"POST /api/proxy/chat/completions","timestamp":"2025-06-27T20:41:44.639Z"}
{"level":"info","message":"Proxy response","result":{"_attempts":[{"provider":"openai","response":{"choices":[{"finish_reason":"stop","index":0,"message":{"content":"Это mock-ответ от OpenAIAdapter.","role":"assistant"}}],"created":1751056904,"id":"chatcmpl-mock123","model":"gpt-3.5-turbo","object":"chat.completion","usage":{"completion_tokens":7,"prompt_tokens":5,"total_tokens":12}},"success":true}],"choices":[{"finish_reason":"stop","index":0,"message":{"content":"Это mock-ответ от OpenAIAdapter.","role":"assistant"}}],"created":1751056904,"id":"chatcmpl-mock123","model":"gpt-3.5-turbo","object":"chat.completion","usage":{"completion_tokens":7,"prompt_tokens":5,"total_tokens":12}},"timestamp":"2025-06-27T20:41:44.641Z"}
{"body":{"messages":[{"content":"hi","role":"user"}],"model":"gpt-3.5-turbo","provider":"openai"},"level":"info","message":"POST /api/proxy/chat/completions","timestamp":"2025-06-27T20:41:44.646Z"}
{"level":"info","message":"Proxy response","result":{"_attempts":[{"provider":"openai","response":{"choices":[{"finish_reason":"stop","index":0,"message":{"content":"Это mock-ответ от OpenAIAdapter.","role":"assistant"}}],"created":1751056904,"id":"chatcmpl-mock123","model":"gpt-3.5-turbo","object":"chat.completion","usage":{"completion_tokens":7,"prompt_tokens":5,"total_tokens":12}},"success":true}],"choices":[{"finish_reason":"stop","index":0,"message":{"content":"Это mock-ответ от OpenAIAdapter.","role":"assistant"}}],"created":1751056904,"id":"chatcmpl-mock123","model":"gpt-3.5-turbo","object":"chat.completion","usage":{"completion_tokens":7,"prompt_tokens":5,"total_tokens":12}},"timestamp":"2025-06-27T20:41:44.648Z"}
{"body":{"messages":[{"content":"hi","role":"user"}],"model":"gpt-3.5-turbo","provider":"openai"},"level":"info","message":"POST /api/proxy/chat/completions","timestamp":"2025-06-27T20:41:44.654Z"}
{"level":"info","message":"Proxy response","result":{"_attempts":[{"provider":"openai","response":{"choices":[{"finish_reason":"stop","index":0,"message":{"content":"Это mock-ответ от OpenAIAdapter.","role":"assistant"}}],"created":1751056904,"id":"chatcmpl-mock123","model":"gpt-3.5-turbo","object":"chat.completion","usage":{"completion_tokens":7,"prompt_tokens":5,"total_tokens":12}},"success":true}],"choices":[{"finish_reason":"stop","index":0,"message":{"content":"Это mock-ответ от OpenAIAdapter.","role":"assistant"}}],"created":1751056904,"id":"chatcmpl-mock123","model":"gpt-3.5-turbo","object":"chat.completion","usage":{"completion_tokens":7,"prompt_tokens":5,"total_tokens":12}},"timestamp":"2025-06-27T20:41:44.656Z"}
{"body":{"messages":[{"content":"fallback test","role":"user"}],"model":"gpt-3.5-turbo","provider":"openai"},"level":"info","message":"POST /api/proxy/chat/completions","timestamp":"2025-06-27T20:41:44.666Z"}
{"level":"info","message":"Proxy response","result":{"_attempts":[{"error":"Mocked OpenAI failure","provider":"openai","success":false},{"provider":"openrouter","response":{"choices":[{"finish_reason":"stop","index":0,"message":{"content":"Это mock-ответ от OpenRouterAdapter.","role":"assistant"}}],"created":1751056904,"id":"orcmpl-mock789","model":"gpt-3.5-turbo","object":"chat.completion","usage":{"completion_tokens":5,"prompt_tokens":3,"total_tokens":8}},"success":true}],"choices":[{"finish_reason":"stop","index":0,"message":{"content":"Это mock-ответ от OpenRouterAdapter.","role":"assistant"}}],"created":1751056904,"id":"orcmpl-mock789","model":"gpt-3.5-turbo","object":"chat.completion","usage":{"completion_tokens":5,"prompt_tokens":3,"total_tokens":8}},"timestamp":"2025-06-27T20:41:44.668Z"}
{"body":{"messages":[{"content":"e2e test","role":"user"}],"model":"openrouter-llm"},"level":"info","message":"POST /api/proxy/chat/completions","timestamp":"2025-06-27T20:42:21.231Z"}
{"level":"info","message":"Proxy response","result":{"_attempts":[{"provider":"openrouter","response":{"choices":[{"finish_reason":"stop","index":0,"message":{"content":"Это mock-ответ от OpenRouterAdapter.","role":"assistant"}}],"created":1751056941,"id":"orcmpl-mock789","model":"openrouter-llm","object":"chat.completion","usage":{"completion_tokens":5,"prompt_tokens":3,"total_tokens":8}},"success":true}],"choices":[{"finish_reason":"stop","index":0,"message":{"content":"Это mock-ответ от OpenRouterAdapter.","role":"assistant"}}],"created":1751056941,"id":"orcmpl-mock789","model":"openrouter-llm","object":"chat.completion","usage":{"completion_tokens":5,"prompt_tokens":3,"total_tokens":8}},"timestamp":"2025-06-27T20:42:21.236Z"}
{"body":{"messages":[{"content":"e2e test","role":"user"}],"model":"openrouter-llm","provider":"openrouter"},"level":"info","message":"POST /api/proxy/chat/completions","timestamp":"2025-06-27T20:42:21.244Z"}
{"level":"info","message":"Proxy response","result":{"_attempts":[{"provider":"openrouter","response":{"choices":[{"finish_reason":"stop","index":0,"message":{"content":"Это mock-ответ от OpenRouterAdapter.","role":"assistant"}}],"created":1751056941,"id":"orcmpl-mock789","model":"openrouter-llm","object":"chat.completion","usage":{"completion_tokens":5,"prompt_tokens":3,"total_tokens":8}},"success":true}],"choices":[{"finish_reason":"stop","index":0,"message":{"content":"Это mock-ответ от OpenRouterAdapter.","role":"assistant"}}],"created":1751056941,"id":"orcmpl-mock789","model":"openrouter-llm","object":"chat.completion","usage":{"completion_tokens":5,"prompt_tokens":3,"total_tokens":8}},"timestamp":"2025-06-27T20:42:21.246Z"}
{"body":{"messages":[{"content":"e2e test","role":"user"}],"model":"gpt-3.5-turbo","provider":"openai"},"level":"info","message":"POST /api/proxy/chat/completions","timestamp":"2025-06-27T20:42:21.254Z"}
{"level":"info","message":"Proxy response","result":{"_attempts":[{"provider":"openai","response":{"choices":[{"finish_reason":"stop","index":0,"message":{"content":"Это mock-ответ от OpenAIAdapter.","role":"assistant"}}],"created":1751056941,"id":"chatcmpl-mock123","model":"gpt-3.5-turbo","object":"chat.completion","usage":{"completion_tokens":7,"prompt_tokens":5,"total_tokens":12}},"success":true}],"choices":[{"finish_reason":"stop","index":0,"message":{"content":"Это mock-ответ от OpenAIAdapter.","role":"assistant"}}],"created":1751056941,"id":"chatcmpl-mock123","model":"gpt-3.5-turbo","object":"chat.completion","usage":{"completion_tokens":7,"prompt_tokens":5,"total_tokens":12}},"timestamp":"2025-06-27T20:42:21.256Z"}
{"body":{"messages":[{"content":"e2e test","role":"user"}]},"level":"info","message":"POST /api/proxy/chat/completions","timestamp":"2025-06-27T20:42:21.263Z"}
{"body":{"messages":[{"content":"e2e test","role":"user"}]},"error":{"issues":[{"code":"invalid_type","expected":"string","message":"Required","path":["model"],"received":"undefined"}],"name":"ZodError"},"level":"warn","message":"Validation error","timestamp":"2025-06-27T20:42:21.267Z"}
{"body":{"model":"openrouter-llm"},"level":"info","message":"POST /api/proxy/chat/completions","timestamp":"2025-06-27T20:42:21.290Z"}
{"body":{"model":"openrouter-llm"},"error":{"issues":[{"code":"invalid_type","expected":"array","message":"Required","path":["messages"],"received":"undefined"}],"name":"ZodError"},"level":"warn","message":"Validation error","timestamp":"2025-06-27T20:42:21.297Z"}
{"body":{"messages":[{"content":"e2e test","role":"user"}],"model":"openrouter-llm","provider":"unknown"},"level":"info","message":"POST /api/proxy/chat/completions","timestamp":"2025-06-27T20:42:21.328Z"}
{"body":{"messages":[{"content":"e2e test","role":"user"}],"model":"openrouter-llm","provider":"unknown"},"error":{"issues":[{"code":"invalid_enum_value","message":"Invalid enum value. Expected 'openrouter' | 'openai', received 'unknown'","options":["openrouter","openai"],"path":["provider"],"received":"unknown"}],"name":"ZodError"},"level":"warn","message":"Validation error","timestamp":"2025-06-27T20:42:21.345Z"}
{"body":{"messages":[{"content":"hi","role":"user"}],"model":"gpt-3.5-turbo","provider":"openai"},"level":"info","message":"POST /api/proxy/chat/completions","timestamp":"2025-06-27T20:42:21.474Z"}
{"level":"info","message":"Proxy response","result":{"_attempts":[{"provider":"openai","response":{"choices":[{"finish_reason":"stop","index":0,"message":{"content":"Это mock-ответ от OpenAIAdapter.","role":"assistant"}}],"created":1751056941,"id":"chatcmpl-mock123","model":"gpt-3.5-turbo","object":"chat.completion","usage":{"completion_tokens":7,"prompt_tokens":5,"total_tokens":12}},"success":true}],"choices":[{"finish_reason":"stop","index":0,"message":{"content":"Это mock-ответ от OpenAIAdapter.","role":"assistant"}}],"created":1751056941,"id":"chatcmpl-mock123","model":"gpt-3.5-turbo","object":"chat.completion","usage":{"completion_tokens":7,"prompt_tokens":5,"total_tokens":12}},"timestamp":"2025-06-27T20:42:21.493Z"}
{"body":{"messages":[{"content":"hi","role":"user"}],"model":"gpt-3.5-turbo","provider":"openai"},"level":"info","message":"POST /api/proxy/chat/completions","timestamp":"2025-06-27T20:42:21.612Z"}
{"level":"info","message":"Proxy response","result":{"_attempts":[{"provider":"openai","response":{"choices":[{"finish_reason":"stop","index":0,"message":{"content":"Это mock-ответ от OpenAIAdapter.","role":"assistant"}}],"created":1751056941,"id":"chatcmpl-mock123","model":"gpt-3.5-turbo","object":"chat.completion","usage":{"completion_tokens":7,"prompt_tokens":5,"total_tokens":12}},"success":true}],"choices":[{"finish_reason":"stop","index":0,"message":{"content":"Это mock-ответ от OpenAIAdapter.","role":"assistant"}}],"created":1751056941,"id":"chatcmpl-mock123","model":"gpt-3.5-turbo","object":"chat.completion","usage":{"completion_tokens":7,"prompt_tokens":5,"total_tokens":12}},"timestamp":"2025-06-27T20:42:21.615Z"}
{"body":{"messages":[{"content":"hi","role":"user"}],"model":"gpt-3.5-turbo","provider":"openai"},"level":"info","message":"POST /api/proxy/chat/completions","timestamp":"2025-06-27T20:42:21.671Z"}
{"level":"info","message":"Proxy response","result":{"_attempts":[{"provider":"openai","response":{"choices":[{"finish_reason":"stop","index":0,"message":{"content":"Это mock-ответ от OpenAIAdapter.","role":"assistant"}}],"created":1751056941,"id":"chatcmpl-mock123","model":"gpt-3.5-turbo","object":"chat.completion","usage":{"completion_tokens":7,"prompt_tokens":5,"total_tokens":12}},"success":true}],"choices":[{"finish_reason":"stop","index":0,"message":{"content":"Это mock-ответ от OpenAIAdapter.","role":"assistant"}}],"created":1751056941,"id":"chatcmpl-mock123","model":"gpt-3.5-turbo","object":"chat.completion","usage":{"completion_tokens":7,"prompt_tokens":5,"total_tokens":12}},"timestamp":"2025-06-27T20:42:21.675Z"}
{"body":{"messages":[{"content":"hi","role":"user"}],"model":"gpt-3.5-turbo","provider":"openai"},"level":"info","message":"POST /api/proxy/chat/completions","timestamp":"2025-06-27T20:42:21.682Z"}
{"level":"info","message":"Proxy response","result":{"_attempts":[{"provider":"openai","response":{"choices":[{"finish_reason":"stop","index":0,"message":{"content":"Это mock-ответ от OpenAIAdapter.","role":"assistant"}}],"created":1751056941,"id":"chatcmpl-mock123","model":"gpt-3.5-turbo","object":"chat.completion","usage":{"completion_tokens":7,"prompt_tokens":5,"total_tokens":12}},"success":true}],"choices":[{"finish_reason":"stop","index":0,"message":{"content":"Это mock-ответ от OpenAIAdapter.","role":"assistant"}}],"created":1751056941,"id":"chatcmpl-mock123","model":"gpt-3.5-turbo","object":"chat.completion","usage":{"completion_tokens":7,"prompt_tokens":5,"total_tokens":12}},"timestamp":"2025-06-27T20:42:21.684Z"}
{"body":{"messages":[{"content":"hi","role":"user"}],"model":"gpt-3.5-turbo","provider":"openai"},"level":"info","message":"POST /api/proxy/chat/completions","timestamp":"2025-06-27T20:42:21.690Z"}
{"level":"info","message":"Proxy response","result":{"_attempts":[{"provider":"openai","response":{"choices":[{"finish_reason":"stop","index":0,"message":{"content":"Это mock-ответ от OpenAIAdapter.","role":"assistant"}}],"created":1751056941,"id":"chatcmpl-mock123","model":"gpt-3.5-turbo","object":"chat.completion","usage":{"completion_tokens":7,"prompt_tokens":5,"total_tokens":12}},"success":true}],"choices":[{"finish_reason":"stop","index":0,"message":{"content":"Это mock-ответ от OpenAIAdapter.","role":"assistant"}}],"created":1751056941,"id":"chatcmpl-mock123","model":"gpt-3.5-turbo","object":"chat.completion","usage":{"completion_tokens":7,"prompt_tokens":5,"total_tokens":12}},"timestamp":"2025-06-27T20:42:21.692Z"}
{"body":{"messages":[{"content":"fallback test","role":"user"}],"model":"gpt-3.5-turbo","provider":"openai"},"level":"info","message":"POST /api/proxy/chat/completions","timestamp":"2025-06-27T20:42:21.705Z"}
{"level":"info","message":"Proxy response","result":{"_attempts":[{"error":"Mocked OpenAI failure","provider":"openai","success":false},{"provider":"openrouter","response":{"choices":[{"finish_reason":"stop","index":0,"message":{"content":"Это mock-ответ от OpenRouterAdapter.","role":"assistant"}}],"created":1751056941,"id":"orcmpl-mock789","model":"gpt-3.5-turbo","object":"chat.completion","usage":{"completion_tokens":5,"prompt_tokens":3,"total_tokens":8}},"success":true}],"choices":[{"finish_reason":"stop","index":0,"message":{"content":"Это mock-ответ от OpenRouterAdapter.","role":"assistant"}}],"created":1751056941,"id":"orcmpl-mock789","model":"gpt-3.5-turbo","object":"chat.completion","usage":{"completion_tokens":5,"prompt_tokens":3,"total_tokens":8}},"timestamp":"2025-06-27T20:42:21.708Z"}
{"timestamp":"2025-07-04 19:43:26","level":"info","message":"Prisma Client initialized","service":"agents-service"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T16:43:26.714Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T16:43:26.727Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T16:43:26.728Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T16:43:26.728Z","url":"http://localhost:3001/api/providers/registry"}
{"timestamp":"2025-07-04 19:43:26","level":"info","message":"Prisma connected successfully","service":"agents-service"}
{"timestamp":"2025-07-04 19:43:26","level":"info","message":"Prisma connected successfully","service":"agents-service"}
{"timestamp":"2025-07-04 19:43:26","level":"info","message":"Prisma disconnected successfully","service":"agents-service"}
{"timestamp":"2025-07-04 19:43:26","level":"info","message":"Prisma disconnected successfully","service":"agents-service"}
{"cacheTimeout":"5 минут","level":"info","message":"Инициализирован ProviderClient","providerServiceUrl":"http://localhost:3001","retryAttempts":3,"timestamp":"2025-07-04T16:43:27.199Z"}
{"healthCheckInterval":"60000ms","level":"info","message":"Инициализирован ProxyProviderService","providers":["proxy6"],"rotationInterval":"300000ms","timestamp":"2025-07-04T16:43:27.202Z"}
{"cacheTimeout":"5 минут","level":"info","message":"Инициализирован ProviderClient","providerServiceUrl":"http://localhost:3001","retryAttempts":3,"timestamp":"2025-07-04T16:43:27.461Z"}
{"healthCheckInterval":"60000ms","level":"info","message":"Инициализирован ProxyProviderService","providers":["proxy6"],"rotationInterval":"300000ms","timestamp":"2025-07-04T16:43:27.463Z"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T16:43:27.732Z","url":"http://localhost:3001/api/providers/registry"}
{"cacheTimeout":"5 минут","level":"info","message":"Инициализирован ProviderClient","providerServiceUrl":"http://localhost:3001","retryAttempts":3,"timestamp":"2025-07-04T16:43:27.904Z"}
{"healthCheckInterval":"60000ms","level":"info","message":"Инициализирован ProxyProviderService","providers":["proxy6"],"rotationInterval":"300000ms","timestamp":"2025-07-04T16:43:27.906Z"}
{"hasReasoning":false,"hasTools":false,"hasUsage":false,"level":"info","message":"Обработка расширенного chat completion запроса","model":"openrouter-llm","provider":"openrouter","timestamp":"2025-07-04T16:43:27.953Z"}
{"enableReasoning":true,"enableToolCalling":true,"level":"info","message":"Обработка запроса через openrouter","messagesCount":1,"model":"openrouter-llm","timestamp":"2025-07-04T16:43:27.953Z"}
{"completionTokens":15,"cost":0.0005,"level":"info","message":"Usage accounting информация","promptTokens":10,"timestamp":"2025-07-04T16:43:27.954Z","totalTokens":25}
{"level":"info","message":"Reasoning токен получен","reasoning":"Это reasoning токен для объяснения ответа.","timestamp":"2025-07-04T16:43:27.954Z"}
{"hasReasoning":true,"hasToolCalls":true,"hasUsage":true,"level":"info","message":"Расширенный chat completion успешно обработан","model":"openrouter-llm","provider":"openrouter","timestamp":"2025-07-04T16:43:27.954Z"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T16:43:29.734Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T16:43:29.734Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T16:43:29.735Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T16:43:29.736Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T16:43:30.739Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T16:43:32.742Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T16:43:32.743Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T16:43:32.743Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T16:43:32.744Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T16:43:33.744Z","url":"http://localhost:3001/api/providers/registry"}
{"level":"info","message":"Очистка кеша провайдеров","timestamp":"2025-07-04T16:43:35.748Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T16:43:35.749Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T16:43:35.749Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T16:43:36.763Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T16:43:38.767Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T16:43:38.768Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T16:43:38.769Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T16:43:38.769Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T16:43:39.770Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T16:43:41.771Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T16:43:41.771Z"}
{"timestamp":"2025-07-04 20:09:15","level":"info","message":"Prisma Client initialized","service":"agents-service"}
{"timestamp":"2025-07-04 20:09:15","level":"info","message":"Prisma connected successfully","service":"agents-service"}
{"timestamp":"2025-07-04 20:09:15","level":"info","message":"Prisma disconnected successfully","service":"agents-service"}
{"timestamp":"2025-07-04 20:09:15","level":"info","message":"Prisma connected successfully","service":"agents-service"}
{"timestamp":"2025-07-04 20:09:15","level":"info","message":"Prisma disconnected successfully","service":"agents-service"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T17:09:16.691Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T17:09:16.701Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T17:09:16.702Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T17:09:16.703Z","url":"http://localhost:3001/api/providers/registry"}
{"cacheTimeout":"5 минут","level":"info","message":"Инициализирован ProviderClient","providerServiceUrl":"http://localhost:3001","retryAttempts":3,"timestamp":"2025-07-04T17:09:17.293Z"}
{"healthCheckInterval":"60000ms","level":"info","message":"Инициализирован ProxyProviderService","providers":["proxy6"],"rotationInterval":"300000ms","timestamp":"2025-07-04T17:09:17.297Z"}
{"hasReasoning":false,"hasTools":false,"hasUsage":false,"level":"info","message":"Обработка расширенного chat completion запроса","model":"openrouter-llm","provider":"openrouter","timestamp":"2025-07-04T17:09:17.338Z"}
{"enableReasoning":true,"enableToolCalling":true,"level":"info","message":"Обработка запроса через openrouter","messagesCount":1,"model":"openrouter-llm","timestamp":"2025-07-04T17:09:17.338Z"}
{"completionTokens":15,"cost":0.0005,"level":"info","message":"Usage accounting информация","promptTokens":10,"timestamp":"2025-07-04T17:09:17.339Z","totalTokens":25}
{"level":"info","message":"Reasoning токен получен","reasoning":"Это reasoning токен для объяснения ответа.","timestamp":"2025-07-04T17:09:17.339Z"}
{"hasReasoning":true,"hasToolCalls":true,"hasUsage":true,"level":"info","message":"Расширенный chat completion успешно обработан","model":"openrouter-llm","provider":"openrouter","timestamp":"2025-07-04T17:09:17.339Z"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T17:09:17.705Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T17:09:19.706Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T17:09:19.706Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T17:09:19.708Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T17:09:19.708Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T17:09:20.709Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T17:09:22.714Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T17:09:22.714Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T17:09:22.715Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T17:09:22.715Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T17:09:23.717Z","url":"http://localhost:3001/api/providers/registry"}
{"level":"info","message":"Очистка кеша провайдеров","timestamp":"2025-07-04T17:09:25.721Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T17:09:25.722Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T17:09:25.722Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T17:09:26.722Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T17:09:28.724Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T17:09:28.724Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T17:09:28.725Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T17:09:28.725Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T17:09:29.726Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T17:09:31.729Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T17:09:31.730Z"}
{"timestamp":"2025-07-04 20:19:16","level":"info","message":"Prisma Client initialized","service":"agents-service"}
{"timestamp":"2025-07-04 20:19:17","level":"info","message":"Prisma connected successfully","service":"agents-service"}
{"timestamp":"2025-07-04 20:19:17","level":"info","message":"Prisma connected successfully","service":"agents-service"}
{"timestamp":"2025-07-04 20:19:17","level":"info","message":"Prisma disconnected successfully","service":"agents-service"}
{"timestamp":"2025-07-04 20:19:17","level":"info","message":"Prisma disconnected successfully","service":"agents-service"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T17:19:19.410Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T17:19:19.962Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T17:19:19.973Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T17:19:19.979Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T17:19:21.439Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T17:19:24.136Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T17:19:24.138Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T17:19:24.224Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T17:19:24.235Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T17:19:25.270Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T17:19:27.330Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T17:19:27.336Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T17:19:27.339Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T17:19:27.341Z","url":"http://localhost:3001/api/providers/registry"}
{"cacheTimeout":"5 минут","level":"info","message":"Инициализирован ProviderClient","providerServiceUrl":"http://localhost:3001","retryAttempts":3,"timestamp":"2025-07-04T17:19:27.757Z"}
{"healthCheckInterval":"60000ms","level":"info","message":"Инициализирован ProxyProviderService","providers":["proxy6"],"rotationInterval":"300000ms","timestamp":"2025-07-04T17:19:27.763Z"}
{"hasReasoning":false,"hasTools":false,"hasUsage":false,"level":"info","message":"Обработка расширенного chat completion запроса","model":"openrouter-llm","provider":"openrouter","timestamp":"2025-07-04T17:19:27.833Z"}
{"enableReasoning":true,"enableToolCalling":true,"level":"info","message":"Обработка запроса через openrouter","messagesCount":1,"model":"openrouter-llm","timestamp":"2025-07-04T17:19:27.833Z"}
{"completionTokens":15,"cost":0.0005,"level":"info","message":"Usage accounting информация","promptTokens":10,"timestamp":"2025-07-04T17:19:27.834Z","totalTokens":25}
{"level":"info","message":"Reasoning токен получен","reasoning":"Это reasoning токен для объяснения ответа.","timestamp":"2025-07-04T17:19:27.834Z"}
{"hasReasoning":true,"hasToolCalls":true,"hasUsage":true,"level":"info","message":"Расширенный chat completion успешно обработан","model":"openrouter-llm","provider":"openrouter","timestamp":"2025-07-04T17:19:27.834Z"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T17:19:28.341Z","url":"http://localhost:3001/api/providers/registry"}
{"level":"info","message":"Очистка кеша провайдеров","timestamp":"2025-07-04T17:19:30.352Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T17:19:30.357Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T17:19:30.358Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T17:19:31.359Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T17:19:33.520Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T17:19:33.529Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T17:19:33.533Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T17:19:33.534Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T17:19:34.574Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T17:19:36.600Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T17:19:36.602Z"}
{"timestamp":"2025-07-04 20:33:06","level":"info","message":"Prisma Client initialized","service":"agents-service"}
{"timestamp":"2025-07-04 20:33:06","level":"error","message":"Error creating agent: Cannot read properties of undefined (reading 'create')","stack":"TypeError: Cannot read properties of undefined (reading 'create')\n    at AgentService.createAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:104:40)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:64:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at runSuite (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)","service":"agents-service"}
{"timestamp":"2025-07-04 20:33:06","level":"error","message":"Failed to connect to Prisma: PrismaService.instance.$connect is not a function","stack":"TypeError: PrismaService.instance.$connect is not a function\n    at Function.connect (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/utils/prisma.ts:20:36)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/e2e/agents.e2e.test.ts:31:25\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runHook (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1436:51)\n    at callSuiteHook (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1442:25)\n    at runSuite (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1708:31)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 20:33:06","level":"error","message":"Failed to disconnect from Prisma: PrismaService.instance.$disconnect is not a function","stack":"TypeError: PrismaService.instance.$disconnect is not a function\n    at Function.disconnect (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/utils/prisma.ts:30:36)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/e2e/agents.e2e.test.ts:35:25\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runHook (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1436:51)\n    at callSuiteHook (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1442:25)\n    at runSuite (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1738:10)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at runSuite (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)","service":"agents-service"}
{"timestamp":"2025-07-04 20:33:06","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:200:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at runSuite (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)","service":"agents-service"}
{"timestamp":"2025-07-04 20:33:06","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:219:33\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at runSuite (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)","service":"agents-service"}
{"timestamp":"2025-07-04 20:33:06","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.updateAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:144:18)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:242:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 20:33:06","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.deleteAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:187:18)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:272:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 20:33:06","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.deleteAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:187:18)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:288:33\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 20:33:06","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.activateAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:222:32)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:306:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 20:33:06","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.deactivateAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:258:32)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:324:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 20:33:06","level":"error","message":"Failed to connect to Prisma: PrismaService.instance.$connect is not a function","stack":"TypeError: PrismaService.instance.$connect is not a function\n    at Function.connect (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/utils/prisma.ts:20:36)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/e2e/orchestration.e2e.test.ts:37:25\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runHook (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1436:51)\n    at callSuiteHook (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1442:25)\n    at runSuite (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1708:31)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 20:33:06","level":"error","message":"Failed to disconnect from Prisma: PrismaService.instance.$disconnect is not a function","stack":"TypeError: PrismaService.instance.$disconnect is not a function\n    at Function.disconnect (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/utils/prisma.ts:30:36)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/e2e/orchestration.e2e.test.ts:41:25\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runHook (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1436:51)\n    at callSuiteHook (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1442:25)\n    at runSuite (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1738:10)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at runSuite (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)","service":"agents-service"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T17:33:07.620Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T17:33:07.632Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T17:33:07.634Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T17:33:07.635Z","url":"http://localhost:3001/api/providers/registry"}
{"cacheTimeout":"5 минут","level":"info","message":"Инициализирован ProviderClient","providerServiceUrl":"http://localhost:3001","retryAttempts":3,"timestamp":"2025-07-04T17:33:08.558Z"}
{"healthCheckInterval":"60000ms","level":"info","message":"Инициализирован ProxyProviderService","providers":["proxy6"],"rotationInterval":"300000ms","timestamp":"2025-07-04T17:33:08.560Z"}
{"hasReasoning":false,"hasTools":false,"hasUsage":false,"level":"info","message":"Обработка расширенного chat completion запроса","model":"openrouter-llm","provider":"openrouter","timestamp":"2025-07-04T17:33:08.619Z"}
{"enableReasoning":true,"enableToolCalling":true,"level":"info","message":"Обработка запроса через openrouter","messagesCount":1,"model":"openrouter-llm","timestamp":"2025-07-04T17:33:08.619Z"}
{"completionTokens":15,"cost":0.0005,"level":"info","message":"Usage accounting информация","promptTokens":10,"timestamp":"2025-07-04T17:33:08.620Z","totalTokens":25}
{"level":"info","message":"Reasoning токен получен","reasoning":"Это reasoning токен для объяснения ответа.","timestamp":"2025-07-04T17:33:08.620Z"}
{"hasReasoning":true,"hasToolCalls":true,"hasUsage":true,"level":"info","message":"Расширенный chat completion успешно обработан","model":"openrouter-llm","provider":"openrouter","timestamp":"2025-07-04T17:33:08.620Z"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T17:33:08.635Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T17:33:10.636Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T17:33:10.637Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T17:33:10.638Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T17:33:10.638Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T17:33:11.640Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T17:33:13.642Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T17:33:13.643Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T17:33:13.645Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T17:33:13.646Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T17:33:14.647Z","url":"http://localhost:3001/api/providers/registry"}
{"level":"info","message":"Очистка кеша провайдеров","timestamp":"2025-07-04T17:33:16.651Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T17:33:16.652Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T17:33:16.653Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T17:33:17.654Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T17:33:19.658Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T17:33:19.658Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T17:33:19.659Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T17:33:19.659Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T17:33:20.661Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T17:33:22.665Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T17:33:22.666Z"}
{"timestamp":"2025-07-04 20:34:19","level":"info","message":"Prisma Client initialized","service":"agents-service"}
{"timestamp":"2025-07-04 20:34:19","level":"error","message":"Error creating agent: Cannot read properties of undefined (reading 'create')","stack":"TypeError: Cannot read properties of undefined (reading 'create')\n    at AgentService.createAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:104:40)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:64:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at runSuite (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)","service":"agents-service"}
{"timestamp":"2025-07-04 20:34:19","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:200:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at runSuite (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)","service":"agents-service"}
{"timestamp":"2025-07-04 20:34:19","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:219:33\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at runSuite (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)","service":"agents-service"}
{"timestamp":"2025-07-04 20:34:19","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.updateAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:144:18)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:242:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 20:34:19","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.deleteAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:187:18)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:272:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 20:34:19","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.deleteAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:187:18)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:288:33\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 20:34:19","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.activateAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:222:32)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:306:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 20:34:19","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.deactivateAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:258:32)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:324:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 20:34:19","level":"info","message":"Prisma connected successfully","service":"agents-service"}
{"timestamp":"2025-07-04 20:34:19","level":"info","message":"Prisma connected successfully","service":"agents-service"}
{"timestamp":"2025-07-04 20:34:19","level":"info","message":"Prisma disconnected successfully","service":"agents-service"}
{"timestamp":"2025-07-04 20:34:19","level":"info","message":"Prisma disconnected successfully","service":"agents-service"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T17:34:20.502Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T17:34:20.507Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T17:34:20.508Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T17:34:20.509Z","url":"http://localhost:3001/api/providers/registry"}
{"cacheTimeout":"5 минут","level":"info","message":"Инициализирован ProviderClient","providerServiceUrl":"http://localhost:3001","retryAttempts":3,"timestamp":"2025-07-04T17:34:21.482Z"}
{"healthCheckInterval":"60000ms","level":"info","message":"Инициализирован ProxyProviderService","providers":["proxy6"],"rotationInterval":"300000ms","timestamp":"2025-07-04T17:34:21.484Z"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T17:34:21.510Z","url":"http://localhost:3001/api/providers/registry"}
{"hasReasoning":false,"hasTools":false,"hasUsage":false,"level":"info","message":"Обработка расширенного chat completion запроса","model":"openrouter-llm","provider":"openrouter","timestamp":"2025-07-04T17:34:21.541Z"}
{"enableReasoning":true,"enableToolCalling":true,"level":"info","message":"Обработка запроса через openrouter","messagesCount":1,"model":"openrouter-llm","timestamp":"2025-07-04T17:34:21.542Z"}
{"completionTokens":15,"cost":0.0005,"level":"info","message":"Usage accounting информация","promptTokens":10,"timestamp":"2025-07-04T17:34:21.542Z","totalTokens":25}
{"level":"info","message":"Reasoning токен получен","reasoning":"Это reasoning токен для объяснения ответа.","timestamp":"2025-07-04T17:34:21.542Z"}
{"hasReasoning":true,"hasToolCalls":true,"hasUsage":true,"level":"info","message":"Расширенный chat completion успешно обработан","model":"openrouter-llm","provider":"openrouter","timestamp":"2025-07-04T17:34:21.548Z"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T17:34:23.512Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T17:34:23.513Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T17:34:23.515Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T17:34:23.515Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T17:34:24.518Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T17:34:26.521Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T17:34:26.522Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T17:34:26.523Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T17:34:26.523Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T17:34:27.523Z","url":"http://localhost:3001/api/providers/registry"}
{"level":"info","message":"Очистка кеша провайдеров","timestamp":"2025-07-04T17:34:29.526Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T17:34:29.527Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T17:34:29.528Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T17:34:30.529Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T17:34:32.581Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T17:34:32.594Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T17:34:32.627Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T17:34:32.679Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T17:34:33.684Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T17:34:35.686Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T17:34:35.687Z"}
{"timestamp":"2025-07-04 20:36:42","level":"error","message":"Error creating agent: Cannot read properties of undefined (reading 'create')","stack":"TypeError: Cannot read properties of undefined (reading 'create')\n    at AgentService.createAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:104:40)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:64:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at runSuite (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)","service":"agents-service"}
{"timestamp":"2025-07-04 20:36:42","level":"info","message":"Prisma Client initialized","service":"agents-service"}
{"timestamp":"2025-07-04 20:36:42","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:200:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at runSuite (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)","service":"agents-service"}
{"timestamp":"2025-07-04 20:36:42","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:219:33\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at runSuite (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)","service":"agents-service"}
{"timestamp":"2025-07-04 20:36:42","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.updateAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:144:18)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:242:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 20:36:42","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.deleteAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:187:18)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:272:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 20:36:42","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.deleteAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:187:18)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:288:33\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 20:36:42","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.activateAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:222:32)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:306:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 20:36:42","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.deactivateAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:258:32)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:324:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 20:36:42","level":"info","message":"Prisma connected successfully","service":"agents-service"}
{"timestamp":"2025-07-04 20:36:42","level":"info","message":"Prisma disconnected successfully","service":"agents-service"}
{"timestamp":"2025-07-04 20:36:43","level":"info","message":"Prisma connected successfully","service":"agents-service"}
{"timestamp":"2025-07-04 20:36:43","level":"info","message":"Prisma disconnected successfully","service":"agents-service"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T17:36:43.928Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T17:36:43.941Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T17:36:43.942Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T17:36:43.943Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T17:36:44.948Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T17:36:47.028Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T17:36:47.034Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T17:36:47.039Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T17:36:47.040Z","url":"http://localhost:3001/api/providers/registry"}
{"cacheTimeout":"5 минут","level":"info","message":"Инициализирован ProviderClient","providerServiceUrl":"http://localhost:3001","retryAttempts":3,"timestamp":"2025-07-04T17:36:47.076Z"}
{"healthCheckInterval":"60000ms","level":"info","message":"Инициализирован ProxyProviderService","providers":["proxy6"],"rotationInterval":"300000ms","timestamp":"2025-07-04T17:36:47.083Z"}
{"hasReasoning":false,"hasTools":false,"hasUsage":false,"level":"info","message":"Обработка расширенного chat completion запроса","model":"openrouter-llm","provider":"openrouter","timestamp":"2025-07-04T17:36:47.212Z"}
{"enableReasoning":true,"enableToolCalling":true,"level":"info","message":"Обработка запроса через openrouter","messagesCount":1,"model":"openrouter-llm","timestamp":"2025-07-04T17:36:47.212Z"}
{"completionTokens":15,"cost":0.0005,"level":"info","message":"Usage accounting информация","promptTokens":10,"timestamp":"2025-07-04T17:36:47.213Z","totalTokens":25}
{"level":"info","message":"Reasoning токен получен","reasoning":"Это reasoning токен для объяснения ответа.","timestamp":"2025-07-04T17:36:47.213Z"}
{"hasReasoning":true,"hasToolCalls":true,"hasUsage":true,"level":"info","message":"Расширенный chat completion успешно обработан","model":"openrouter-llm","provider":"openrouter","timestamp":"2025-07-04T17:36:47.213Z"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T17:36:48.041Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T17:36:50.065Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T17:36:50.072Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T17:36:50.080Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T17:36:50.080Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T17:36:51.083Z","url":"http://localhost:3001/api/providers/registry"}
{"level":"info","message":"Очистка кеша провайдеров","timestamp":"2025-07-04T17:36:53.089Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T17:36:53.090Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T17:36:53.092Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T17:36:54.093Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T17:36:56.153Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T17:36:56.154Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T17:36:56.155Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T17:36:56.161Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T17:36:57.164Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T17:36:59.166Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T17:36:59.166Z"}
{"timestamp":"2025-07-04 20:38:12","level":"error","message":"Error creating agent: Cannot read properties of undefined (reading 'create')","stack":"TypeError: Cannot read properties of undefined (reading 'create')\n    at AgentService.createAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:104:40)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:64:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at runSuite (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)","service":"agents-service"}
{"timestamp":"2025-07-04 20:38:12","level":"info","message":"Prisma Client initialized","service":"agents-service"}
{"timestamp":"2025-07-04 20:38:12","level":"info","message":"Prisma connected successfully","service":"agents-service"}
{"timestamp":"2025-07-04 20:38:12","level":"info","message":"Prisma connected successfully","service":"agents-service"}
{"timestamp":"2025-07-04 20:38:12","level":"info","message":"Prisma disconnected successfully","service":"agents-service"}
{"timestamp":"2025-07-04 20:38:12","level":"info","message":"Prisma disconnected successfully","service":"agents-service"}
{"timestamp":"2025-07-04 20:38:12","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:200:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at runSuite (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)","service":"agents-service"}
{"timestamp":"2025-07-04 20:38:12","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:219:33\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at runSuite (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)","service":"agents-service"}
{"timestamp":"2025-07-04 20:38:12","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.updateAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:144:18)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:242:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 20:38:12","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.deleteAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:187:18)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:272:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 20:38:12","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.deleteAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:187:18)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:288:33\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 20:38:12","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.activateAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:222:32)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:306:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 20:38:12","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.deactivateAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:258:32)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:324:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T17:38:13.657Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T17:38:13.662Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T17:38:13.663Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T17:38:13.664Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T17:38:14.665Z","url":"http://localhost:3001/api/providers/registry"}
{"cacheTimeout":"5 минут","level":"info","message":"Инициализирован ProviderClient","providerServiceUrl":"http://localhost:3001","retryAttempts":3,"timestamp":"2025-07-04T17:38:15.018Z"}
{"healthCheckInterval":"60000ms","level":"info","message":"Инициализирован ProxyProviderService","providers":["proxy6"],"rotationInterval":"300000ms","timestamp":"2025-07-04T17:38:15.023Z"}
{"hasReasoning":false,"hasTools":false,"hasUsage":false,"level":"info","message":"Обработка расширенного chat completion запроса","model":"openrouter-llm","provider":"openrouter","timestamp":"2025-07-04T17:38:15.111Z"}
{"enableReasoning":true,"enableToolCalling":true,"level":"info","message":"Обработка запроса через openrouter","messagesCount":1,"model":"openrouter-llm","timestamp":"2025-07-04T17:38:15.111Z"}
{"completionTokens":15,"cost":0.0005,"level":"info","message":"Usage accounting информация","promptTokens":10,"timestamp":"2025-07-04T17:38:15.114Z","totalTokens":25}
{"level":"info","message":"Reasoning токен получен","reasoning":"Это reasoning токен для объяснения ответа.","timestamp":"2025-07-04T17:38:15.115Z"}
{"hasReasoning":true,"hasToolCalls":true,"hasUsage":true,"level":"info","message":"Расширенный chat completion успешно обработан","model":"openrouter-llm","provider":"openrouter","timestamp":"2025-07-04T17:38:15.115Z"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T17:38:16.719Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T17:38:16.911Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T17:38:16.969Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T17:38:16.970Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T17:38:17.972Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T17:38:19.974Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T17:38:19.975Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T17:38:19.976Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T17:38:19.977Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T17:38:20.979Z","url":"http://localhost:3001/api/providers/registry"}
{"level":"info","message":"Очистка кеша провайдеров","timestamp":"2025-07-04T17:38:22.986Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T17:38:22.987Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T17:38:22.988Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T17:38:23.990Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T17:38:25.991Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T17:38:25.991Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T17:38:25.992Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T17:38:25.993Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T17:38:26.995Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T17:38:28.998Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T17:38:28.998Z"}
{"timestamp":"2025-07-04 22:59:40","level":"error","message":"Error creating agent: Cannot read properties of undefined (reading 'create')","stack":"TypeError: Cannot read properties of undefined (reading 'create')\n    at AgentService.createAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:104:40)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:64:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at runSuite (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)","service":"agents-service"}
{"timestamp":"2025-07-04 22:59:40","level":"info","message":"Prisma Client initialized","service":"agents-service"}
{"timestamp":"2025-07-04 22:59:40","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:200:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at runSuite (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)","service":"agents-service"}
{"timestamp":"2025-07-04 22:59:40","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:219:33\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at runSuite (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)","service":"agents-service"}
{"timestamp":"2025-07-04 22:59:40","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.updateAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:144:18)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:242:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 22:59:40","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.deleteAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:187:18)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:272:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 22:59:40","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.deleteAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:187:18)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:288:33\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 22:59:40","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.activateAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:222:32)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:306:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 22:59:40","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.deactivateAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:258:32)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:324:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 22:59:40","level":"info","message":"Prisma connected successfully","service":"agents-service"}
{"timestamp":"2025-07-04 22:59:40","level":"info","message":"Prisma disconnected successfully","service":"agents-service"}
{"timestamp":"2025-07-04 22:59:40","level":"info","message":"Prisma connected successfully","service":"agents-service"}
{"timestamp":"2025-07-04 22:59:40","level":"info","message":"Prisma disconnected successfully","service":"agents-service"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T19:59:41.458Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T19:59:41.463Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T19:59:41.464Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T19:59:41.465Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T19:59:42.466Z","url":"http://localhost:3001/api/providers/registry"}
{"cacheTimeout":"5 минут","level":"info","message":"Инициализирован ProviderClient","providerServiceUrl":"http://localhost:3001","retryAttempts":3,"timestamp":"2025-07-04T19:59:42.621Z"}
{"healthCheckInterval":"60000ms","level":"info","message":"Инициализирован ProxyProviderService","providers":["proxy6"],"rotationInterval":"300000ms","timestamp":"2025-07-04T19:59:42.624Z"}
{"hasReasoning":false,"hasTools":false,"hasUsage":false,"level":"info","message":"Обработка расширенного chat completion запроса","model":"openrouter-llm","provider":"openrouter","timestamp":"2025-07-04T19:59:42.791Z"}
{"enableReasoning":true,"enableToolCalling":true,"level":"info","message":"Обработка запроса через openrouter","messagesCount":1,"model":"openrouter-llm","timestamp":"2025-07-04T19:59:42.791Z"}
{"completionTokens":15,"cost":0.0005,"level":"info","message":"Usage accounting информация","promptTokens":10,"timestamp":"2025-07-04T19:59:42.791Z","totalTokens":25}
{"level":"info","message":"Reasoning токен получен","reasoning":"Это reasoning токен для объяснения ответа.","timestamp":"2025-07-04T19:59:42.792Z"}
{"hasReasoning":true,"hasToolCalls":true,"hasUsage":true,"level":"info","message":"Расширенный chat completion успешно обработан","model":"openrouter-llm","provider":"openrouter","timestamp":"2025-07-04T19:59:42.792Z"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T19:59:44.468Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T19:59:44.469Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T19:59:44.471Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T19:59:44.471Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T19:59:45.472Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T19:59:47.474Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T19:59:47.474Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T19:59:47.475Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T19:59:47.475Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T19:59:48.477Z","url":"http://localhost:3001/api/providers/registry"}
{"level":"info","message":"Очистка кеша провайдеров","timestamp":"2025-07-04T19:59:50.482Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T19:59:50.483Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T19:59:50.484Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T19:59:51.486Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T19:59:53.488Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T19:59:53.488Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T19:59:53.489Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T19:59:53.489Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T19:59:54.490Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T19:59:56.492Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T19:59:56.492Z"}
{"timestamp":"2025-07-04 23:13:17","level":"info","message":"Prisma Client initialized","service":"agents-service"}
{"timestamp":"2025-07-04 23:13:17","level":"error","message":"Error creating agent: Cannot read properties of undefined (reading 'create')","stack":"TypeError: Cannot read properties of undefined (reading 'create')\n    at AgentService.createAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:104:40)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:64:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at runSuite (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)","service":"agents-service"}
{"timestamp":"2025-07-04 23:13:17","level":"info","message":"Prisma connected successfully","service":"agents-service"}
{"timestamp":"2025-07-04 23:13:17","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:200:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at runSuite (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)","service":"agents-service"}
{"timestamp":"2025-07-04 23:13:17","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:219:33\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at runSuite (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)","service":"agents-service"}
{"timestamp":"2025-07-04 23:13:17","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.updateAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:144:18)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:242:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 23:13:17","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.deleteAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:187:18)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:272:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 23:13:17","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.deleteAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:187:18)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:288:33\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 23:13:17","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.activateAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:222:32)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:306:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 23:13:17","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.deactivateAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:258:32)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:324:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 23:13:17","level":"info","message":"Prisma disconnected successfully","service":"agents-service"}
{"timestamp":"2025-07-04 23:13:17","level":"info","message":"Prisma connected successfully","service":"agents-service"}
{"timestamp":"2025-07-04 23:13:17","level":"info","message":"Prisma disconnected successfully","service":"agents-service"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:13:18.596Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:13:18.604Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:13:18.605Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T20:13:18.605Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T20:13:19.666Z","url":"http://localhost:3001/api/providers/registry"}
{"cacheTimeout":"5 минут","level":"info","message":"Инициализирован ProviderClient","providerServiceUrl":"http://localhost:3001","retryAttempts":3,"timestamp":"2025-07-04T20:13:20.267Z"}
{"healthCheckInterval":"60000ms","level":"info","message":"Инициализирован ProxyProviderService","providers":["proxy6"],"rotationInterval":"300000ms","timestamp":"2025-07-04T20:13:20.268Z"}
{"hasReasoning":false,"hasTools":false,"hasUsage":false,"level":"info","message":"Обработка расширенного chat completion запроса","model":"openrouter-llm","provider":"openrouter","timestamp":"2025-07-04T20:13:20.382Z"}
{"enableReasoning":true,"enableToolCalling":true,"level":"info","message":"Обработка запроса через openrouter","messagesCount":1,"model":"openrouter-llm","timestamp":"2025-07-04T20:13:20.383Z"}
{"completionTokens":15,"cost":0.0005,"level":"info","message":"Usage accounting информация","promptTokens":10,"timestamp":"2025-07-04T20:13:20.383Z","totalTokens":25}
{"level":"info","message":"Reasoning токен получен","reasoning":"Это reasoning токен для объяснения ответа.","timestamp":"2025-07-04T20:13:20.383Z"}
{"hasReasoning":true,"hasToolCalls":true,"hasUsage":true,"level":"info","message":"Расширенный chat completion успешно обработан","model":"openrouter-llm","provider":"openrouter","timestamp":"2025-07-04T20:13:20.383Z"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T20:13:21.671Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T20:13:21.672Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:13:21.674Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T20:13:21.675Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T20:13:22.676Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T20:13:24.678Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T20:13:24.678Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:13:24.679Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T20:13:24.680Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T20:13:25.681Z","url":"http://localhost:3001/api/providers/registry"}
{"level":"info","message":"Очистка кеша провайдеров","timestamp":"2025-07-04T20:13:27.684Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:13:27.685Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T20:13:27.685Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T20:13:28.688Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T20:13:30.694Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T20:13:30.694Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:13:30.695Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T20:13:30.695Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T20:13:31.698Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T20:13:33.699Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T20:13:33.700Z"}
{"timestamp":"2025-07-04 23:19:08","level":"info","message":"Prisma Client initialized","service":"agents-service"}
{"timestamp":"2025-07-04 23:19:08","level":"error","message":"Error creating agent: Cannot read properties of undefined (reading 'create')","stack":"TypeError: Cannot read properties of undefined (reading 'create')\n    at AgentService.createAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:104:40)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:64:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at runSuite (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)","service":"agents-service"}
{"timestamp":"2025-07-04 23:19:08","level":"info","message":"Prisma connected successfully","service":"agents-service"}
{"timestamp":"2025-07-04 23:19:08","level":"info","message":"Prisma disconnected successfully","service":"agents-service"}
{"timestamp":"2025-07-04 23:19:08","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:200:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at runSuite (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)","service":"agents-service"}
{"timestamp":"2025-07-04 23:19:08","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:219:33\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at runSuite (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)","service":"agents-service"}
{"timestamp":"2025-07-04 23:19:08","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.updateAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:144:18)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:242:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 23:19:08","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.deleteAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:187:18)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:272:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 23:19:08","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.deleteAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:187:18)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:288:33\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 23:19:08","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.activateAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:222:32)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:306:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 23:19:08","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.deactivateAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:258:32)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:324:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 23:19:08","level":"info","message":"Prisma connected successfully","service":"agents-service"}
{"timestamp":"2025-07-04 23:19:08","level":"info","message":"Prisma disconnected successfully","service":"agents-service"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:19:09.606Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:19:09.613Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:19:09.616Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T20:19:09.630Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T20:19:10.660Z","url":"http://localhost:3001/api/providers/registry"}
{"cacheTimeout":"5 минут","level":"info","message":"Инициализирован ProviderClient","providerServiceUrl":"http://localhost:3001","retryAttempts":3,"timestamp":"2025-07-04T20:19:11.150Z"}
{"healthCheckInterval":"60000ms","level":"info","message":"Инициализирован ProxyProviderService","providers":["proxy6"],"rotationInterval":"300000ms","timestamp":"2025-07-04T20:19:11.156Z"}
{"hasReasoning":false,"hasTools":false,"hasUsage":false,"level":"info","message":"Обработка расширенного chat completion запроса","model":"openrouter-llm","provider":"openrouter","timestamp":"2025-07-04T20:19:11.245Z"}
{"enableReasoning":true,"enableToolCalling":true,"level":"info","message":"Обработка запроса через openrouter","messagesCount":1,"model":"openrouter-llm","timestamp":"2025-07-04T20:19:11.246Z"}
{"completionTokens":15,"cost":0.0005,"level":"info","message":"Usage accounting информация","promptTokens":10,"timestamp":"2025-07-04T20:19:11.247Z","totalTokens":25}
{"level":"info","message":"Reasoning токен получен","reasoning":"Это reasoning токен для объяснения ответа.","timestamp":"2025-07-04T20:19:11.247Z"}
{"hasReasoning":true,"hasToolCalls":true,"hasUsage":true,"level":"info","message":"Расширенный chat completion успешно обработан","model":"openrouter-llm","provider":"openrouter","timestamp":"2025-07-04T20:19:11.248Z"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T20:19:12.663Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T20:19:12.664Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:19:12.671Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T20:19:12.672Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T20:19:13.673Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T20:19:15.682Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T20:19:15.690Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:19:15.695Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T20:19:15.695Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T20:19:16.706Z","url":"http://localhost:3001/api/providers/registry"}
{"level":"info","message":"Очистка кеша провайдеров","timestamp":"2025-07-04T20:19:18.711Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:19:18.713Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T20:19:18.714Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T20:19:19.715Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T20:19:21.716Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T20:19:21.717Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:19:21.718Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T20:19:21.718Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T20:19:22.720Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T20:19:24.722Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T20:19:24.722Z"}
{"timestamp":"2025-07-04 23:20:37","level":"info","message":"Prisma Client initialized","service":"agents-service"}
{"timestamp":"2025-07-04 23:20:37","level":"error","message":"Error creating agent: Cannot read properties of undefined (reading 'create')","stack":"TypeError: Cannot read properties of undefined (reading 'create')\n    at AgentService.createAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:104:40)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:64:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at runSuite (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)","service":"agents-service"}
{"timestamp":"2025-07-04 23:20:37","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:200:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at runSuite (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)","service":"agents-service"}
{"timestamp":"2025-07-04 23:20:37","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:219:33\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at runSuite (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)","service":"agents-service"}
{"timestamp":"2025-07-04 23:20:37","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.updateAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:144:18)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:242:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 23:20:37","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.deleteAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:187:18)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:272:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 23:20:37","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.deleteAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:187:18)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:288:33\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 23:20:37","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.activateAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:222:32)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:306:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 23:20:37","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.deactivateAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:258:32)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:324:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 23:20:37","level":"info","message":"Prisma connected successfully","service":"agents-service"}
{"timestamp":"2025-07-04 23:20:37","level":"info","message":"Prisma connected successfully","service":"agents-service"}
{"timestamp":"2025-07-04 23:20:37","level":"info","message":"Prisma disconnected successfully","service":"agents-service"}
{"timestamp":"2025-07-04 23:20:37","level":"info","message":"Prisma disconnected successfully","service":"agents-service"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:20:38.451Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:20:38.475Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:20:38.476Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T20:20:38.480Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T20:20:39.489Z","url":"http://localhost:3001/api/providers/registry"}
{"cacheTimeout":"5 минут","level":"info","message":"Инициализирован ProviderClient","providerServiceUrl":"http://localhost:3001","retryAttempts":3,"timestamp":"2025-07-04T20:20:41.004Z"}
{"healthCheckInterval":"60000ms","level":"info","message":"Инициализирован ProxyProviderService","providers":["proxy6"],"rotationInterval":"300000ms","timestamp":"2025-07-04T20:20:41.009Z"}
{"hasReasoning":false,"hasTools":false,"hasUsage":false,"level":"info","message":"Обработка расширенного chat completion запроса","model":"openrouter-llm","provider":"openrouter","timestamp":"2025-07-04T20:20:41.078Z"}
{"enableReasoning":true,"enableToolCalling":true,"level":"info","message":"Обработка запроса через openrouter","messagesCount":1,"model":"openrouter-llm","timestamp":"2025-07-04T20:20:41.086Z"}
{"completionTokens":15,"cost":0.0005,"level":"info","message":"Usage accounting информация","promptTokens":10,"timestamp":"2025-07-04T20:20:41.087Z","totalTokens":25}
{"level":"info","message":"Reasoning токен получен","reasoning":"Это reasoning токен для объяснения ответа.","timestamp":"2025-07-04T20:20:41.097Z"}
{"hasReasoning":true,"hasToolCalls":true,"hasUsage":true,"level":"info","message":"Расширенный chat completion успешно обработан","model":"openrouter-llm","provider":"openrouter","timestamp":"2025-07-04T20:20:41.104Z"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T20:20:41.493Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T20:20:41.498Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:20:41.501Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T20:20:41.502Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T20:20:42.504Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T20:20:44.518Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T20:20:44.519Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:20:44.523Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T20:20:44.526Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T20:20:45.526Z","url":"http://localhost:3001/api/providers/registry"}
{"level":"info","message":"Очистка кеша провайдеров","timestamp":"2025-07-04T20:20:47.531Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:20:47.533Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T20:20:47.534Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T20:20:48.535Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T20:20:50.747Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T20:20:50.748Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:20:50.766Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T20:20:50.767Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T20:20:51.769Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T20:20:53.804Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T20:20:53.806Z"}
{"timestamp":"2025-07-04 23:25:12","level":"info","message":"Prisma Client initialized","service":"agents-service"}
{"timestamp":"2025-07-04 23:25:12","level":"error","message":"Error creating agent: Cannot read properties of undefined (reading 'create')","stack":"TypeError: Cannot read properties of undefined (reading 'create')\n    at AgentService.createAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:104:40)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:64:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at runSuite (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)","service":"agents-service"}
{"timestamp":"2025-07-04 23:25:12","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:200:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at runSuite (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)","service":"agents-service"}
{"timestamp":"2025-07-04 23:25:12","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:219:33\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at runSuite (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)","service":"agents-service"}
{"timestamp":"2025-07-04 23:25:12","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.updateAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:144:18)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:242:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 23:25:12","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.deleteAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:187:18)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:272:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 23:25:12","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.deleteAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:187:18)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:288:33\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 23:25:12","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.activateAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:222:32)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:306:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 23:25:12","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.deactivateAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:258:32)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:324:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 23:25:12","level":"info","message":"Prisma connected successfully","service":"agents-service"}
{"timestamp":"2025-07-04 23:25:12","level":"info","message":"Prisma connected successfully","service":"agents-service"}
{"timestamp":"2025-07-04 23:25:12","level":"info","message":"Prisma disconnected successfully","service":"agents-service"}
{"timestamp":"2025-07-04 23:25:12","level":"info","message":"Prisma disconnected successfully","service":"agents-service"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:25:12.923Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:25:12.928Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:25:12.928Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T20:25:12.929Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T20:25:14.019Z","url":"http://localhost:3001/api/providers/registry"}
{"cacheTimeout":"5 минут","level":"info","message":"Инициализирован ProviderClient","providerServiceUrl":"http://localhost:3001","retryAttempts":3,"timestamp":"2025-07-04T20:25:14.683Z"}
{"healthCheckInterval":"60000ms","level":"info","message":"Инициализирован ProxyProviderService","providers":["proxy6"],"rotationInterval":"300000ms","timestamp":"2025-07-04T20:25:14.687Z"}
{"hasReasoning":false,"hasTools":false,"hasUsage":false,"level":"info","message":"Обработка расширенного chat completion запроса","model":"openrouter-llm","provider":"openrouter","timestamp":"2025-07-04T20:25:14.801Z"}
{"enableReasoning":true,"enableToolCalling":true,"level":"info","message":"Обработка запроса через openrouter","messagesCount":1,"model":"openrouter-llm","timestamp":"2025-07-04T20:25:14.802Z"}
{"completionTokens":15,"cost":0.0005,"level":"info","message":"Usage accounting информация","promptTokens":10,"timestamp":"2025-07-04T20:25:14.803Z","totalTokens":25}
{"level":"info","message":"Reasoning токен получен","reasoning":"Это reasoning токен для объяснения ответа.","timestamp":"2025-07-04T20:25:14.803Z"}
{"hasReasoning":true,"hasToolCalls":true,"hasUsage":true,"level":"info","message":"Расширенный chat completion успешно обработан","model":"openrouter-llm","provider":"openrouter","timestamp":"2025-07-04T20:25:14.804Z"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T20:25:16.050Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T20:25:16.051Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:25:16.052Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T20:25:16.052Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T20:25:17.053Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T20:25:19.056Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T20:25:19.057Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:25:19.058Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T20:25:19.058Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T20:25:20.059Z","url":"http://localhost:3001/api/providers/registry"}
{"level":"info","message":"Очистка кеша провайдеров","timestamp":"2025-07-04T20:25:22.063Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:25:22.064Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T20:25:22.064Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T20:25:23.065Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T20:25:25.066Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T20:25:25.066Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:25:25.067Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T20:25:25.067Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T20:25:26.068Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T20:25:28.069Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T20:25:28.069Z"}
{"timestamp":"2025-07-04 23:26:22","level":"info","message":"Prisma Client initialized","service":"agents-service"}
{"timestamp":"2025-07-04 23:26:22","level":"error","message":"Error creating agent: Cannot read properties of undefined (reading 'create')","stack":"TypeError: Cannot read properties of undefined (reading 'create')\n    at AgentService.createAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:104:40)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:64:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at runSuite (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)","service":"agents-service"}
{"timestamp":"2025-07-04 23:26:22","level":"info","message":"Prisma connected successfully","service":"agents-service"}
{"timestamp":"2025-07-04 23:26:22","level":"info","message":"Prisma connected successfully","service":"agents-service"}
{"timestamp":"2025-07-04 23:26:22","level":"info","message":"Prisma disconnected successfully","service":"agents-service"}
{"timestamp":"2025-07-04 23:26:22","level":"info","message":"Prisma disconnected successfully","service":"agents-service"}
{"timestamp":"2025-07-04 23:26:22","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:200:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at runSuite (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)","service":"agents-service"}
{"timestamp":"2025-07-04 23:26:22","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:219:33\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at runSuite (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)","service":"agents-service"}
{"timestamp":"2025-07-04 23:26:22","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.updateAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:144:18)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:242:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 23:26:22","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.deleteAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:187:18)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:272:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 23:26:22","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.deleteAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:187:18)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:288:33\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 23:26:22","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.activateAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:222:32)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:306:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 23:26:22","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.deactivateAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:258:32)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:324:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:26:23.089Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:26:23.094Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:26:23.095Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T20:26:23.096Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T20:26:24.099Z","url":"http://localhost:3001/api/providers/registry"}
{"cacheTimeout":"5 минут","level":"info","message":"Инициализирован ProviderClient","providerServiceUrl":"http://localhost:3001","retryAttempts":3,"timestamp":"2025-07-04T20:26:24.886Z"}
{"healthCheckInterval":"60000ms","level":"info","message":"Инициализирован ProxyProviderService","providers":["proxy6"],"rotationInterval":"300000ms","timestamp":"2025-07-04T20:26:24.889Z"}
{"hasReasoning":false,"hasTools":false,"hasUsage":false,"level":"info","message":"Обработка расширенного chat completion запроса","model":"openrouter-llm","provider":"openrouter","timestamp":"2025-07-04T20:26:24.981Z"}
{"enableReasoning":true,"enableToolCalling":true,"level":"info","message":"Обработка запроса через openrouter","messagesCount":1,"model":"openrouter-llm","timestamp":"2025-07-04T20:26:24.981Z"}
{"completionTokens":15,"cost":0.0005,"level":"info","message":"Usage accounting информация","promptTokens":10,"timestamp":"2025-07-04T20:26:24.982Z","totalTokens":25}
{"level":"info","message":"Reasoning токен получен","reasoning":"Это reasoning токен для объяснения ответа.","timestamp":"2025-07-04T20:26:24.982Z"}
{"hasReasoning":true,"hasToolCalls":true,"hasUsage":true,"level":"info","message":"Расширенный chat completion успешно обработан","model":"openrouter-llm","provider":"openrouter","timestamp":"2025-07-04T20:26:24.982Z"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T20:26:26.100Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T20:26:26.101Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:26:26.104Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T20:26:26.105Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T20:26:27.107Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T20:26:29.110Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T20:26:29.110Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:26:29.112Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T20:26:29.112Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T20:26:30.113Z","url":"http://localhost:3001/api/providers/registry"}
{"level":"info","message":"Очистка кеша провайдеров","timestamp":"2025-07-04T20:26:32.117Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:26:32.118Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T20:26:32.119Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T20:26:33.120Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T20:26:35.123Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T20:26:35.124Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:26:35.126Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T20:26:35.126Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T20:26:36.127Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T20:26:38.129Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T20:26:38.129Z"}
{"timestamp":"2025-07-04 23:28:22","level":"info","message":"Prisma Client initialized","service":"agents-service"}
{"timestamp":"2025-07-04 23:28:22","level":"error","message":"Error creating agent: Cannot read properties of undefined (reading 'create')","stack":"TypeError: Cannot read properties of undefined (reading 'create')\n    at AgentService.createAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:104:40)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:64:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at runSuite (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)","service":"agents-service"}
{"timestamp":"2025-07-04 23:28:22","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:200:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at runSuite (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)","service":"agents-service"}
{"timestamp":"2025-07-04 23:28:22","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:219:33\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at runSuite (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)","service":"agents-service"}
{"timestamp":"2025-07-04 23:28:22","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.updateAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:144:18)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:242:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 23:28:22","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.deleteAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:187:18)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:272:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 23:28:22","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.deleteAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:187:18)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:288:33\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 23:28:22","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.activateAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:222:32)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:306:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 23:28:22","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.deactivateAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:258:32)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:324:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 23:28:23","level":"info","message":"Prisma connected successfully","service":"agents-service"}
{"timestamp":"2025-07-04 23:28:23","level":"info","message":"Prisma connected successfully","service":"agents-service"}
{"timestamp":"2025-07-04 23:28:23","level":"info","message":"Prisma disconnected successfully","service":"agents-service"}
{"timestamp":"2025-07-04 23:28:23","level":"info","message":"Prisma disconnected successfully","service":"agents-service"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:28:23.561Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:28:23.565Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:28:23.566Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T20:28:23.567Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T20:28:24.568Z","url":"http://localhost:3001/api/providers/registry"}
{"cacheTimeout":"5 минут","level":"info","message":"Инициализирован ProviderClient","providerServiceUrl":"http://localhost:3001","retryAttempts":3,"timestamp":"2025-07-04T20:28:24.661Z"}
{"healthCheckInterval":"60000ms","level":"info","message":"Инициализирован ProxyProviderService","providers":["proxy6"],"rotationInterval":"300000ms","timestamp":"2025-07-04T20:28:24.663Z"}
{"hasReasoning":false,"hasTools":false,"hasUsage":false,"level":"info","message":"Обработка расширенного chat completion запроса","model":"openrouter-llm","provider":"openrouter","timestamp":"2025-07-04T20:28:24.725Z"}
{"enableReasoning":true,"enableToolCalling":true,"level":"info","message":"Обработка запроса через openrouter","messagesCount":1,"model":"openrouter-llm","timestamp":"2025-07-04T20:28:24.726Z"}
{"completionTokens":15,"cost":0.0005,"level":"info","message":"Usage accounting информация","promptTokens":10,"timestamp":"2025-07-04T20:28:24.727Z","totalTokens":25}
{"level":"info","message":"Reasoning токен получен","reasoning":"Это reasoning токен для объяснения ответа.","timestamp":"2025-07-04T20:28:24.728Z"}
{"hasReasoning":true,"hasToolCalls":true,"hasUsage":true,"level":"info","message":"Расширенный chat completion успешно обработан","model":"openrouter-llm","provider":"openrouter","timestamp":"2025-07-04T20:28:24.729Z"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T20:28:26.570Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T20:28:26.571Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:28:26.572Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T20:28:26.572Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T20:28:27.576Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T20:28:29.578Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T20:28:29.579Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:28:29.582Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T20:28:29.583Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T20:28:30.697Z","url":"http://localhost:3001/api/providers/registry"}
{"level":"info","message":"Очистка кеша провайдеров","timestamp":"2025-07-04T20:28:32.711Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:28:32.713Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T20:28:32.713Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T20:28:33.714Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T20:28:35.716Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T20:28:35.717Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:28:35.717Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T20:28:35.718Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T20:28:36.720Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T20:28:38.722Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T20:28:38.722Z"}
{"timestamp":"2025-07-04 23:30:13","level":"info","message":"Prisma Client initialized","service":"agents-service"}
{"timestamp":"2025-07-04 23:30:13","level":"error","message":"Error creating agent: Cannot read properties of undefined (reading 'create')","stack":"TypeError: Cannot read properties of undefined (reading 'create')\n    at AgentService.createAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:104:40)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:64:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at runSuite (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)","service":"agents-service"}
{"timestamp":"2025-07-04 23:30:13","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:200:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at runSuite (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)","service":"agents-service"}
{"timestamp":"2025-07-04 23:30:13","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:219:33\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at runSuite (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)","service":"agents-service"}
{"timestamp":"2025-07-04 23:30:13","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.updateAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:144:18)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:242:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 23:30:13","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.deleteAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:187:18)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:272:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 23:30:13","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.deleteAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:187:18)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:288:33\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 23:30:13","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.activateAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:222:32)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:306:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 23:30:13","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.deactivateAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:258:32)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:324:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 23:30:13","level":"info","message":"Prisma connected successfully","service":"agents-service"}
{"timestamp":"2025-07-04 23:30:13","level":"info","message":"Prisma connected successfully","service":"agents-service"}
{"timestamp":"2025-07-04 23:30:13","level":"info","message":"Prisma disconnected successfully","service":"agents-service"}
{"timestamp":"2025-07-04 23:30:13","level":"info","message":"Prisma disconnected successfully","service":"agents-service"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:30:14.087Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:30:14.117Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:30:14.119Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T20:30:14.192Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T20:30:15.206Z","url":"http://localhost:3001/api/providers/registry"}
{"cacheTimeout":"5 минут","level":"info","message":"Инициализирован ProviderClient","providerServiceUrl":"http://localhost:3001","retryAttempts":3,"timestamp":"2025-07-04T20:30:16.029Z"}
{"healthCheckInterval":"60000ms","level":"info","message":"Инициализирован ProxyProviderService","providers":["proxy6"],"rotationInterval":"300000ms","timestamp":"2025-07-04T20:30:16.032Z"}
{"hasReasoning":false,"hasTools":false,"hasUsage":false,"level":"info","message":"Обработка расширенного chat completion запроса","model":"openrouter-llm","provider":"openrouter","timestamp":"2025-07-04T20:30:16.100Z"}
{"enableReasoning":true,"enableToolCalling":true,"level":"info","message":"Обработка запроса через openrouter","messagesCount":1,"model":"openrouter-llm","timestamp":"2025-07-04T20:30:16.100Z"}
{"completionTokens":15,"cost":0.0005,"level":"info","message":"Usage accounting информация","promptTokens":10,"timestamp":"2025-07-04T20:30:16.101Z","totalTokens":25}
{"level":"info","message":"Reasoning токен получен","reasoning":"Это reasoning токен для объяснения ответа.","timestamp":"2025-07-04T20:30:16.101Z"}
{"hasReasoning":true,"hasToolCalls":true,"hasUsage":true,"level":"info","message":"Расширенный chat completion успешно обработан","model":"openrouter-llm","provider":"openrouter","timestamp":"2025-07-04T20:30:16.101Z"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T20:30:17.236Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T20:30:17.241Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:30:17.243Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T20:30:17.246Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T20:30:18.315Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T20:30:20.374Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T20:30:20.375Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:30:20.377Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T20:30:20.377Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T20:30:21.379Z","url":"http://localhost:3001/api/providers/registry"}
{"level":"info","message":"Очистка кеша провайдеров","timestamp":"2025-07-04T20:30:23.383Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:30:23.384Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T20:30:23.384Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T20:30:24.385Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T20:30:26.389Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T20:30:26.391Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:30:26.392Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T20:30:26.394Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T20:30:27.395Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T20:30:29.398Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T20:30:29.399Z"}
{"timestamp":"2025-07-04 23:32:53","level":"info","message":"Prisma Client initialized","service":"agents-service"}
{"timestamp":"2025-07-04 23:32:53","level":"error","message":"Error creating agent: Cannot read properties of undefined (reading 'create')","stack":"TypeError: Cannot read properties of undefined (reading 'create')\n    at AgentService.createAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:104:40)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:64:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at runSuite (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)","service":"agents-service"}
{"timestamp":"2025-07-04 23:32:53","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:200:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at runSuite (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)","service":"agents-service"}
{"timestamp":"2025-07-04 23:32:53","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:219:33\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at runSuite (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)","service":"agents-service"}
{"timestamp":"2025-07-04 23:32:53","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.updateAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:144:18)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:242:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 23:32:53","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.deleteAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:187:18)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:272:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 23:32:53","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.deleteAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:187:18)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:288:33\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 23:32:53","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.activateAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:222:32)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:306:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 23:32:53","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.deactivateAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:258:32)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:324:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 23:32:53","level":"info","message":"Prisma connected successfully","service":"agents-service"}
{"timestamp":"2025-07-04 23:32:53","level":"info","message":"Prisma connected successfully","service":"agents-service"}
{"timestamp":"2025-07-04 23:32:53","level":"info","message":"Prisma disconnected successfully","service":"agents-service"}
{"timestamp":"2025-07-04 23:32:53","level":"info","message":"Prisma disconnected successfully","service":"agents-service"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:32:54.369Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:32:54.375Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:32:54.375Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T20:32:54.376Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T20:32:55.381Z","url":"http://localhost:3001/api/providers/registry"}
{"cacheTimeout":"5 минут","level":"info","message":"Инициализирован ProviderClient","providerServiceUrl":"http://localhost:3001","retryAttempts":3,"timestamp":"2025-07-04T20:32:56.076Z"}
{"healthCheckInterval":"60000ms","level":"info","message":"Инициализирован ProxyProviderService","providers":["proxy6"],"rotationInterval":"300000ms","timestamp":"2025-07-04T20:32:56.078Z"}
{"hasReasoning":false,"hasTools":false,"hasUsage":false,"level":"info","message":"Обработка расширенного chat completion запроса","model":"openrouter-llm","provider":"openrouter","timestamp":"2025-07-04T20:32:56.153Z"}
{"enableReasoning":true,"enableToolCalling":true,"level":"info","message":"Обработка запроса через openrouter","messagesCount":1,"model":"openrouter-llm","timestamp":"2025-07-04T20:32:56.153Z"}
{"completionTokens":15,"cost":0.0005,"level":"info","message":"Usage accounting информация","promptTokens":10,"timestamp":"2025-07-04T20:32:56.153Z","totalTokens":25}
{"level":"info","message":"Reasoning токен получен","reasoning":"Это reasoning токен для объяснения ответа.","timestamp":"2025-07-04T20:32:56.154Z"}
{"hasReasoning":true,"hasToolCalls":true,"hasUsage":true,"level":"info","message":"Расширенный chat completion успешно обработан","model":"openrouter-llm","provider":"openrouter","timestamp":"2025-07-04T20:32:56.154Z"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T20:32:57.389Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T20:32:57.404Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:32:57.426Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T20:32:57.427Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T20:32:58.429Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T20:33:00.433Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T20:33:00.434Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:33:00.435Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T20:33:00.435Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T20:33:01.436Z","url":"http://localhost:3001/api/providers/registry"}
{"level":"info","message":"Очистка кеша провайдеров","timestamp":"2025-07-04T20:33:03.441Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:33:03.443Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T20:33:03.443Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T20:33:04.444Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T20:33:06.447Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T20:33:06.448Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:33:06.450Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T20:33:06.450Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T20:33:07.452Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T20:33:09.454Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T20:33:09.455Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:36:09.799Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:36:09.812Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:36:09.813Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T20:36:09.814Z","url":"http://localhost:3001/api/providers/registry"}
{"timestamp":"2025-07-04 23:36:09","level":"info","message":"Prisma Client initialized","service":"agents-service"}
{"timestamp":"2025-07-04 23:36:09","level":"error","message":"Error creating agent: Cannot read properties of undefined (reading 'create')","stack":"TypeError: Cannot read properties of undefined (reading 'create')\n    at AgentService.createAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:104:40)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:64:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at runSuite (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)","service":"agents-service"}
{"timestamp":"2025-07-04 23:36:09","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:200:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at runSuite (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)","service":"agents-service"}
{"timestamp":"2025-07-04 23:36:09","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:219:33\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at runSuite (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)","service":"agents-service"}
{"timestamp":"2025-07-04 23:36:09","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.updateAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:144:18)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:242:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 23:36:09","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.deleteAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:187:18)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:272:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 23:36:09","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.deleteAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:187:18)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:288:33\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 23:36:09","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.activateAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:222:32)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:306:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 23:36:09","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.deactivateAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:258:32)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:324:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 23:36:09","level":"info","message":"Prisma connected successfully","service":"agents-service"}
{"timestamp":"2025-07-04 23:36:09","level":"info","message":"Prisma connected successfully","service":"agents-service"}
{"timestamp":"2025-07-04 23:36:09","level":"info","message":"Prisma disconnected successfully","service":"agents-service"}
{"timestamp":"2025-07-04 23:36:09","level":"info","message":"Prisma disconnected successfully","service":"agents-service"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T20:36:10.815Z","url":"http://localhost:3001/api/providers/registry"}
{"cacheTimeout":"5 минут","level":"info","message":"Инициализирован ProviderClient","providerServiceUrl":"http://localhost:3001","retryAttempts":3,"timestamp":"2025-07-04T20:36:11.266Z"}
{"healthCheckInterval":"60000ms","level":"info","message":"Инициализирован ProxyProviderService","providers":["proxy6"],"rotationInterval":"300000ms","timestamp":"2025-07-04T20:36:11.270Z"}
{"hasReasoning":false,"hasTools":false,"hasUsage":false,"level":"info","message":"Обработка расширенного chat completion запроса","model":"openrouter-llm","provider":"openrouter","timestamp":"2025-07-04T20:36:11.344Z"}
{"enableReasoning":true,"enableToolCalling":true,"level":"info","message":"Обработка запроса через openrouter","messagesCount":1,"model":"openrouter-llm","timestamp":"2025-07-04T20:36:11.344Z"}
{"completionTokens":15,"cost":0.0005,"level":"info","message":"Usage accounting информация","promptTokens":10,"timestamp":"2025-07-04T20:36:11.345Z","totalTokens":25}
{"level":"info","message":"Reasoning токен получен","reasoning":"Это reasoning токен для объяснения ответа.","timestamp":"2025-07-04T20:36:11.345Z"}
{"hasReasoning":true,"hasToolCalls":true,"hasUsage":true,"level":"info","message":"Расширенный chat completion успешно обработан","model":"openrouter-llm","provider":"openrouter","timestamp":"2025-07-04T20:36:11.345Z"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T20:36:12.818Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T20:36:12.820Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:36:12.823Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T20:36:12.824Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T20:36:13.825Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T20:36:15.827Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T20:36:15.827Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:36:15.828Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T20:36:15.828Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T20:36:16.829Z","url":"http://localhost:3001/api/providers/registry"}
{"level":"info","message":"Очистка кеша провайдеров","timestamp":"2025-07-04T20:36:18.833Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:36:18.834Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T20:36:18.834Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T20:36:19.835Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T20:36:21.838Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T20:36:21.838Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:36:21.840Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T20:36:21.840Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T20:36:22.841Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T20:36:24.842Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T20:36:24.842Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:37:18.206Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:37:18.211Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:37:18.213Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T20:37:18.214Z","url":"http://localhost:3001/api/providers/registry"}
{"timestamp":"2025-07-04 23:37:18","level":"info","message":"Prisma Client initialized","service":"agents-service"}
{"timestamp":"2025-07-04 23:37:18","level":"error","message":"Error creating agent: Cannot read properties of undefined (reading 'create')","stack":"TypeError: Cannot read properties of undefined (reading 'create')\n    at AgentService.createAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:104:40)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:64:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at runSuite (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)","service":"agents-service"}
{"timestamp":"2025-07-04 23:37:18","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:200:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at runSuite (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)","service":"agents-service"}
{"timestamp":"2025-07-04 23:37:18","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:219:33\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at runSuite (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)","service":"agents-service"}
{"timestamp":"2025-07-04 23:37:18","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.updateAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:144:18)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:242:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 23:37:18","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.deleteAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:187:18)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:272:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 23:37:18","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.deleteAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:187:18)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:288:33\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 23:37:18","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.activateAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:222:32)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:306:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 23:37:18","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.deactivateAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:258:32)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:324:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 23:37:18","level":"info","message":"Prisma connected successfully","service":"agents-service"}
{"timestamp":"2025-07-04 23:37:18","level":"info","message":"Prisma connected successfully","service":"agents-service"}
{"timestamp":"2025-07-04 23:37:18","level":"info","message":"Prisma disconnected successfully","service":"agents-service"}
{"timestamp":"2025-07-04 23:37:18","level":"info","message":"Prisma disconnected successfully","service":"agents-service"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T20:37:19.216Z","url":"http://localhost:3001/api/providers/registry"}
{"cacheTimeout":"5 минут","level":"info","message":"Инициализирован ProviderClient","providerServiceUrl":"http://localhost:3001","retryAttempts":3,"timestamp":"2025-07-04T20:37:19.468Z"}
{"healthCheckInterval":"60000ms","level":"info","message":"Инициализирован ProxyProviderService","providers":["proxy6"],"rotationInterval":"300000ms","timestamp":"2025-07-04T20:37:19.470Z"}
{"hasReasoning":false,"hasTools":false,"hasUsage":false,"level":"info","message":"Обработка расширенного chat completion запроса","model":"openrouter-llm","provider":"openrouter","timestamp":"2025-07-04T20:37:19.546Z"}
{"enableReasoning":true,"enableToolCalling":true,"level":"info","message":"Обработка запроса через openrouter","messagesCount":1,"model":"openrouter-llm","timestamp":"2025-07-04T20:37:19.546Z"}
{"completionTokens":15,"cost":0.0005,"level":"info","message":"Usage accounting информация","promptTokens":10,"timestamp":"2025-07-04T20:37:19.547Z","totalTokens":25}
{"level":"info","message":"Reasoning токен получен","reasoning":"Это reasoning токен для объяснения ответа.","timestamp":"2025-07-04T20:37:19.547Z"}
{"hasReasoning":true,"hasToolCalls":true,"hasUsage":true,"level":"info","message":"Расширенный chat completion успешно обработан","model":"openrouter-llm","provider":"openrouter","timestamp":"2025-07-04T20:37:19.547Z"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T20:37:21.230Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T20:37:21.231Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:37:21.233Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T20:37:21.234Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T20:37:22.235Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T20:37:24.237Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T20:37:24.238Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:37:24.239Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T20:37:24.239Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T20:37:25.240Z","url":"http://localhost:3001/api/providers/registry"}
{"level":"info","message":"Очистка кеша провайдеров","timestamp":"2025-07-04T20:37:27.245Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:37:27.246Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T20:37:27.246Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T20:37:28.247Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T20:37:30.249Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T20:37:30.249Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:37:30.250Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T20:37:30.251Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T20:37:31.252Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T20:37:33.253Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T20:37:33.253Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:38:13.037Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:38:13.047Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:38:13.048Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T20:38:13.049Z","url":"http://localhost:3001/api/providers/registry"}
{"timestamp":"2025-07-04 23:38:13","level":"info","message":"Prisma Client initialized","service":"agents-service"}
{"timestamp":"2025-07-04 23:38:13","level":"error","message":"Error creating agent: Cannot read properties of undefined (reading 'create')","stack":"TypeError: Cannot read properties of undefined (reading 'create')\n    at AgentService.createAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:104:40)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:64:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at runSuite (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)","service":"agents-service"}
{"timestamp":"2025-07-04 23:38:13","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:200:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at runSuite (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)","service":"agents-service"}
{"timestamp":"2025-07-04 23:38:13","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:219:33\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at runSuite (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)","service":"agents-service"}
{"timestamp":"2025-07-04 23:38:13","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.updateAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:144:18)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:242:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 23:38:13","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.deleteAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:187:18)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:272:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 23:38:13","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.deleteAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:187:18)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:288:33\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 23:38:13","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.activateAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:222:32)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:306:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 23:38:13","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.deactivateAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:258:32)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:324:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 23:38:13","level":"info","message":"Prisma connected successfully","service":"agents-service"}
{"timestamp":"2025-07-04 23:38:13","level":"info","message":"Prisma connected successfully","service":"agents-service"}
{"timestamp":"2025-07-04 23:38:13","level":"info","message":"Prisma disconnected successfully","service":"agents-service"}
{"timestamp":"2025-07-04 23:38:13","level":"info","message":"Prisma disconnected successfully","service":"agents-service"}
{"cacheTimeout":"5 минут","level":"info","message":"Инициализирован ProviderClient","providerServiceUrl":"http://localhost:3001","retryAttempts":3,"timestamp":"2025-07-04T20:38:13.866Z"}
{"healthCheckInterval":"60000ms","level":"info","message":"Инициализирован ProxyProviderService","providers":["proxy6"],"rotationInterval":"300000ms","timestamp":"2025-07-04T20:38:13.868Z"}
{"hasReasoning":false,"hasTools":false,"hasUsage":false,"level":"info","message":"Обработка расширенного chat completion запроса","model":"openrouter-llm","provider":"openrouter","timestamp":"2025-07-04T20:38:13.930Z"}
{"enableReasoning":true,"enableToolCalling":true,"level":"info","message":"Обработка запроса через openrouter","messagesCount":1,"model":"openrouter-llm","timestamp":"2025-07-04T20:38:13.930Z"}
{"completionTokens":15,"cost":0.0005,"level":"info","message":"Usage accounting информация","promptTokens":10,"timestamp":"2025-07-04T20:38:13.931Z","totalTokens":25}
{"level":"info","message":"Reasoning токен получен","reasoning":"Это reasoning токен для объяснения ответа.","timestamp":"2025-07-04T20:38:13.931Z"}
{"hasReasoning":true,"hasToolCalls":true,"hasUsage":true,"level":"info","message":"Расширенный chat completion успешно обработан","model":"openrouter-llm","provider":"openrouter","timestamp":"2025-07-04T20:38:13.931Z"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T20:38:14.051Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T20:38:16.053Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T20:38:16.053Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:38:16.054Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T20:38:16.054Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T20:38:17.056Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T20:38:19.057Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T20:38:19.058Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:38:19.059Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T20:38:19.059Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T20:38:20.060Z","url":"http://localhost:3001/api/providers/registry"}
{"level":"info","message":"Очистка кеша провайдеров","timestamp":"2025-07-04T20:38:22.064Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:38:22.065Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T20:38:22.065Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T20:38:23.067Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T20:38:25.079Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T20:38:25.083Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:38:25.084Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T20:38:25.085Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T20:38:26.087Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T20:38:28.088Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T20:38:28.089Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:39:35.765Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:39:35.772Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:39:35.773Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T20:39:35.773Z","url":"http://localhost:3001/api/providers/registry"}
{"timestamp":"2025-07-04 23:39:35","level":"info","message":"Prisma Client initialized","service":"agents-service"}
{"timestamp":"2025-07-04 23:39:35","level":"error","message":"Error creating agent: Cannot read properties of undefined (reading 'create')","stack":"TypeError: Cannot read properties of undefined (reading 'create')\n    at AgentService.createAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:104:40)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:64:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at runSuite (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)","service":"agents-service"}
{"timestamp":"2025-07-04 23:39:35","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:200:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at runSuite (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)","service":"agents-service"}
{"timestamp":"2025-07-04 23:39:35","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:219:33\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at runSuite (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)","service":"agents-service"}
{"timestamp":"2025-07-04 23:39:35","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.updateAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:144:18)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:242:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 23:39:35","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.deleteAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:187:18)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:272:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 23:39:35","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.deleteAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:187:18)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:288:33\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 23:39:35","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.activateAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:222:32)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:306:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 23:39:35","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.deactivateAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:258:32)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:324:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 23:39:35","level":"info","message":"Prisma connected successfully","service":"agents-service"}
{"timestamp":"2025-07-04 23:39:35","level":"info","message":"Prisma connected successfully","service":"agents-service"}
{"timestamp":"2025-07-04 23:39:35","level":"info","message":"Prisma disconnected successfully","service":"agents-service"}
{"timestamp":"2025-07-04 23:39:35","level":"info","message":"Prisma disconnected successfully","service":"agents-service"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T20:39:36.775Z","url":"http://localhost:3001/api/providers/registry"}
{"cacheTimeout":"5 минут","level":"info","message":"Инициализирован ProviderClient","providerServiceUrl":"http://localhost:3001","retryAttempts":3,"timestamp":"2025-07-04T20:39:36.830Z"}
{"healthCheckInterval":"60000ms","level":"info","message":"Инициализирован ProxyProviderService","providers":["proxy6"],"rotationInterval":"300000ms","timestamp":"2025-07-04T20:39:36.832Z"}
{"hasReasoning":false,"hasTools":false,"hasUsage":false,"level":"info","message":"Обработка расширенного chat completion запроса","model":"openrouter-llm","provider":"openrouter","timestamp":"2025-07-04T20:39:36.884Z"}
{"enableReasoning":true,"enableToolCalling":true,"level":"info","message":"Обработка запроса через openrouter","messagesCount":1,"model":"openrouter-llm","timestamp":"2025-07-04T20:39:36.885Z"}
{"completionTokens":15,"cost":0.0005,"level":"info","message":"Usage accounting информация","promptTokens":10,"timestamp":"2025-07-04T20:39:36.885Z","totalTokens":25}
{"level":"info","message":"Reasoning токен получен","reasoning":"Это reasoning токен для объяснения ответа.","timestamp":"2025-07-04T20:39:36.885Z"}
{"hasReasoning":true,"hasToolCalls":true,"hasUsage":true,"level":"info","message":"Расширенный chat completion успешно обработан","model":"openrouter-llm","provider":"openrouter","timestamp":"2025-07-04T20:39:36.886Z"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T20:39:38.778Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T20:39:38.779Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:39:38.784Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T20:39:38.784Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T20:39:39.786Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T20:39:41.788Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T20:39:41.789Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:39:41.789Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T20:39:41.789Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T20:39:42.790Z","url":"http://localhost:3001/api/providers/registry"}
{"level":"info","message":"Очистка кеша провайдеров","timestamp":"2025-07-04T20:39:44.793Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:39:44.794Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T20:39:44.794Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T20:39:45.795Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T20:39:47.797Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T20:39:47.799Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:39:47.801Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T20:39:47.801Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T20:39:48.804Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T20:39:50.805Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T20:39:50.805Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:41:05.006Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:41:05.011Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:41:05.012Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T20:41:05.013Z","url":"http://localhost:3001/api/providers/registry"}
{"timestamp":"2025-07-04 23:41:05","level":"info","message":"Prisma Client initialized","service":"agents-service"}
{"timestamp":"2025-07-04 23:41:05","level":"error","message":"Error creating agent: Cannot read properties of undefined (reading 'create')","stack":"TypeError: Cannot read properties of undefined (reading 'create')\n    at AgentService.createAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:104:40)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:64:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at runSuite (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)","service":"agents-service"}
{"timestamp":"2025-07-04 23:41:05","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:200:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at runSuite (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)","service":"agents-service"}
{"timestamp":"2025-07-04 23:41:05","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:219:33\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at runSuite (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)","service":"agents-service"}
{"timestamp":"2025-07-04 23:41:05","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.updateAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:144:18)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:242:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 23:41:05","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.deleteAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:187:18)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:272:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 23:41:05","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.deleteAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:187:18)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:288:33\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 23:41:05","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.activateAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:222:32)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:306:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 23:41:05","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.deactivateAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:258:32)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:324:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-04 23:41:05","level":"info","message":"Prisma connected successfully","service":"agents-service"}
{"timestamp":"2025-07-04 23:41:05","level":"info","message":"Prisma connected successfully","service":"agents-service"}
{"timestamp":"2025-07-04 23:41:05","level":"info","message":"Prisma disconnected successfully","service":"agents-service"}
{"timestamp":"2025-07-04 23:41:05","level":"info","message":"Prisma disconnected successfully","service":"agents-service"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T20:41:06.025Z","url":"http://localhost:3001/api/providers/registry"}
{"cacheTimeout":"5 минут","level":"info","message":"Инициализирован ProviderClient","providerServiceUrl":"http://localhost:3001","retryAttempts":3,"timestamp":"2025-07-04T20:41:07.961Z"}
{"healthCheckInterval":"60000ms","level":"info","message":"Инициализирован ProxyProviderService","providers":["proxy6"],"rotationInterval":"300000ms","timestamp":"2025-07-04T20:41:07.964Z"}
{"hasReasoning":false,"hasTools":false,"hasUsage":false,"level":"info","message":"Обработка расширенного chat completion запроса","model":"openrouter-llm","provider":"openrouter","timestamp":"2025-07-04T20:41:08.028Z"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T20:41:08.028Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T20:41:08.029Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:41:08.036Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T20:41:08.036Z","url":"http://localhost:3001/api/providers/registry"}
{"enableReasoning":true,"enableToolCalling":true,"level":"info","message":"Обработка запроса через openrouter","messagesCount":1,"model":"openrouter-llm","timestamp":"2025-07-04T20:41:08.029Z"}
{"completionTokens":15,"cost":0.0005,"level":"info","message":"Usage accounting информация","promptTokens":10,"timestamp":"2025-07-04T20:41:08.030Z","totalTokens":25}
{"level":"info","message":"Reasoning токен получен","reasoning":"Это reasoning токен для объяснения ответа.","timestamp":"2025-07-04T20:41:08.030Z"}
{"hasReasoning":true,"hasToolCalls":true,"hasUsage":true,"level":"info","message":"Расширенный chat completion успешно обработан","model":"openrouter-llm","provider":"openrouter","timestamp":"2025-07-04T20:41:08.030Z"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T20:41:09.334Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T20:41:11.340Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T20:41:11.341Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:41:11.342Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T20:41:11.343Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T20:41:12.344Z","url":"http://localhost:3001/api/providers/registry"}
{"level":"info","message":"Очистка кеша провайдеров","timestamp":"2025-07-04T20:41:14.349Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:41:14.350Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T20:41:14.351Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T20:41:15.352Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T20:41:17.357Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T20:41:17.357Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-04T20:41:17.361Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-04T20:41:17.365Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-04T20:41:18.365Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-04T20:41:20.405Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-04T20:41:20.407Z"}
{"timestamp":"2025-07-07 16:40:12","level":"info","message":"Prisma Client initialized","service":"agents-service"}
{"timestamp":"2025-07-07 16:40:12","level":"error","message":"Error creating agent: Cannot read properties of undefined (reading 'create')","stack":"TypeError: Cannot read properties of undefined (reading 'create')\n    at AgentService.createAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:104:40)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:64:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at runSuite (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)","service":"agents-service"}
{"timestamp":"2025-07-07 16:40:12","level":"error","message":"Failed to connect to Prisma: Can't reach database server at `localhost:5432`\n\nPlease make sure your database server is running at `localhost:5432`.","stack":"PrismaClientInitializationError: Can't reach database server at `localhost:5432`\n\nPlease make sure your database server is running at `localhost:5432`.\n    at r (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/node_modules/@prisma/client/runtime/library.js:112:2770)\n    at Function.connect (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/utils/prisma.ts:20:7)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/e2e/agents.e2e.test.ts:12:5","service":"agents-service","clientVersion":"6.11.1","errorCode":"P1001","name":"PrismaClientInitializationError"}
{"timestamp":"2025-07-07 16:40:12","level":"info","message":"Prisma disconnected successfully","service":"agents-service"}
{"timestamp":"2025-07-07 16:40:12","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:200:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at runSuite (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)","service":"agents-service"}
{"timestamp":"2025-07-07 16:40:12","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:219:33\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at runSuite (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)","service":"agents-service"}
{"timestamp":"2025-07-07 16:40:12","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.updateAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:144:18)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:242:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-07 16:40:12","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.deleteAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:187:18)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:272:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-07 16:40:12","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.deleteAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:187:18)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:288:33\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-07 16:40:12","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.activateAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:222:32)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:306:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-07 16:40:12","level":"error","message":"Error getting agent by ID: Cannot read properties of undefined (reading 'findUnique')","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at AgentService.getAgentById (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:70:40)\n    at AgentService.deactivateAgent (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentService.ts:258:32)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/services/AgentService.test.ts:324:41\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"agents-service"}
{"timestamp":"2025-07-07 16:40:12","level":"error","message":"Failed to connect to Prisma: Can't reach database server at `localhost:5432`\n\nPlease make sure your database server is running at `localhost:5432`.","stack":"PrismaClientInitializationError: Can't reach database server at `localhost:5432`\n\nPlease make sure your database server is running at `localhost:5432`.\n    at r (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/node_modules/@prisma/client/runtime/library.js:112:2770)\n    at Function.connect (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/utils/prisma.ts:20:7)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/e2e/orchestration.e2e.test.ts:18:5","service":"agents-service","clientVersion":"6.11.1","errorCode":"P1001","name":"PrismaClientInitializationError"}
{"timestamp":"2025-07-07 16:40:12","level":"info","message":"Prisma disconnected successfully","service":"agents-service"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-07T13:40:12.594Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-07T13:40:12.598Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-07T13:40:12.599Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-07T13:40:12.599Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-07T13:40:13.600Z","url":"http://localhost:3001/api/providers/registry"}
{"cacheTimeout":"5 минут","level":"info","message":"Инициализирован ProviderClient","providerServiceUrl":"http://localhost:3001","retryAttempts":3,"timestamp":"2025-07-07T13:40:13.799Z"}
{"healthCheckInterval":"60000ms","level":"info","message":"Инициализирован ProxyProviderService","providers":["proxy6"],"rotationInterval":"300000ms","timestamp":"2025-07-07T13:40:13.802Z"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-07T13:40:15.602Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-07T13:40:15.602Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-07T13:40:15.604Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-07T13:40:15.604Z","url":"http://localhost:3001/api/providers/registry"}
{"hasReasoning":false,"hasTools":false,"hasUsage":false,"level":"info","message":"Обработка расширенного chat completion запроса","model":"openrouter-llm","provider":"openrouter","timestamp":"2025-07-07T13:40:15.825Z"}
{"enableReasoning":true,"enableToolCalling":true,"level":"info","message":"Обработка запроса через openrouter","messagesCount":1,"model":"openrouter-llm","timestamp":"2025-07-07T13:40:15.825Z"}
{"completionTokens":15,"cost":0.0005,"level":"info","message":"Usage accounting информация","promptTokens":10,"timestamp":"2025-07-07T13:40:15.826Z","totalTokens":25}
{"level":"info","message":"Reasoning токен получен","reasoning":"Это reasoning токен для объяснения ответа.","timestamp":"2025-07-07T13:40:15.826Z"}
{"hasReasoning":true,"hasToolCalls":true,"hasUsage":true,"level":"info","message":"Расширенный chat completion успешно обработан","model":"openrouter-llm","provider":"openrouter","timestamp":"2025-07-07T13:40:15.826Z"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-07T13:40:16.605Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-07T13:40:18.607Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-07T13:40:18.608Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-07T13:40:18.608Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-07T13:40:18.608Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-07T13:40:19.610Z","url":"http://localhost:3001/api/providers/registry"}
{"level":"info","message":"Очистка кеша провайдеров","timestamp":"2025-07-07T13:40:21.614Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-07T13:40:21.615Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-07T13:40:21.615Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-07T13:40:22.616Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-07T13:40:24.618Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-07T13:40:24.619Z"}
{"level":"info","message":"Запрос справочника провайдеров из provider-service","timestamp":"2025-07-07T13:40:24.619Z"}
{"attempt":1,"error":{},"level":"warn","message":"Попытка 1 не удалась","timestamp":"2025-07-07T13:40:24.619Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":2,"error":{},"level":"warn","message":"Попытка 2 не удалась","timestamp":"2025-07-07T13:40:25.621Z","url":"http://localhost:3001/api/providers/registry"}
{"attempt":3,"error":{},"level":"warn","message":"Попытка 3 не удалась","timestamp":"2025-07-07T13:40:27.623Z","url":"http://localhost:3001/api/providers/registry"}
{"error":{},"level":"error","message":"Ошибка при получении справочника провайдеров","timestamp":"2025-07-07T13:40:27.624Z"}
{"timestamp":"2025-07-11 12:24:35","level":"info","message":"Customer request triaged","service":"agents-service","category":"technical","priority":"medium","escalation":false}
{"timestamp":"2025-07-11 12:24:35","level":"info","message":"Customer request triaged","service":"agents-service","category":"billing","priority":"medium","escalation":true}
{"timestamp":"2025-07-11 12:24:35","level":"info","message":"Customer request triaged","service":"agents-service","category":"general","priority":"high","escalation":true}
{"timestamp":"2025-07-11 12:24:35","level":"info","message":"Customer request triaged","service":"agents-service","category":"complaint","priority":"high","escalation":true}
{"timestamp":"2025-07-11 12:24:35","level":"info","message":"Customer request triaged","service":"agents-service","category":"general","priority":"low","escalation":false}
{"timestamp":"2025-07-11 12:24:35","level":"error","message":"Error triaging customer request","service":"agents-service","error":{}}
{"timestamp":"2025-07-11 12:24:35","level":"info","message":"Customer conversation handled","service":"agents-service","customerId":"customer-123","escalate":false,"actionsCount":1}
{"timestamp":"2025-07-11 12:24:35","level":"info","message":"Customer conversation handled","service":"agents-service","customerId":"customer-frustrated","escalate":true,"actionsCount":0}
{"timestamp":"2025-07-11 12:24:35","level":"info","message":"Customer conversation handled","service":"agents-service","customerId":"customer-satisfied","escalate":false,"actionsCount":1}
{"timestamp":"2025-07-11 12:24:35","level":"info","message":"Customer conversation handled","service":"agents-service","customerId":"customer-refund","escalate":false,"actionsCount":1}
{"timestamp":"2025-07-11 12:24:35","level":"info","message":"Support ticket created","service":"agents-service","ticketId":"TICKET_1752225875634","customerId":"customer-urgent","priority":"high"}
{"timestamp":"2025-07-11 12:24:35","level":"info","message":"Human agent notified","service":"agents-service","agentId":"tech_agent_1","ticketId":"TICKET_1752225875634","priority":"high"}
{"timestamp":"2025-07-11 12:24:35","level":"info","message":"Case escalated to human agent","service":"agents-service","ticketId":"TICKET_1752225875634","assignedAgent":"tech_agent_1","priority":"high"}
{"timestamp":"2025-07-11 12:24:35","level":"info","message":"Support ticket created","service":"agents-service","ticketId":"TICKET_1752225875635","customerId":"customer-urgent","priority":"urgent"}
{"timestamp":"2025-07-11 12:24:35","level":"info","message":"Human agent notified","service":"agents-service","agentId":"tech_agent_2","ticketId":"TICKET_1752225875635","priority":"urgent"}
{"timestamp":"2025-07-11 12:24:35","level":"info","message":"Case escalated to human agent","service":"agents-service","ticketId":"TICKET_1752225875635","assignedAgent":"tech_agent_2","priority":"urgent"}
{"timestamp":"2025-07-11 12:24:35","level":"info","message":"Support ticket created","service":"agents-service","ticketId":"TICKET_1752225875636","customerId":"customer-billing","priority":"medium"}
{"timestamp":"2025-07-11 12:24:35","level":"info","message":"Human agent notified","service":"agents-service","agentId":"billing_agent_2","ticketId":"TICKET_1752225875636","priority":"medium"}
{"timestamp":"2025-07-11 12:24:35","level":"info","message":"Case escalated to human agent","service":"agents-service","ticketId":"TICKET_1752225875636","assignedAgent":"billing_agent_2","priority":"medium"}
{"timestamp":"2025-07-11 12:24:35","level":"info","message":"Support ticket created","service":"agents-service","ticketId":"TICKET_1752225875636","customerId":"customer-vip","priority":"high"}
{"timestamp":"2025-07-11 12:24:35","level":"info","message":"Human agent notified","service":"agents-service","agentId":"support_agent_3","ticketId":"TICKET_1752225875636","priority":"high"}
{"timestamp":"2025-07-11 12:24:35","level":"info","message":"Case escalated to human agent","service":"agents-service","ticketId":"TICKET_1752225875636","assignedAgent":"support_agent_3","priority":"high"}
{"timestamp":"2025-07-11 12:24:35","level":"info","message":"Customer request triaged","service":"agents-service","category":"general","priority":"low","escalation":false}
{"timestamp":"2025-07-11 12:24:35","level":"info","message":"Customer request triaged","service":"agents-service","category":"complaint","priority":"medium","escalation":true}
{"timestamp":"2025-07-11 12:24:35","level":"info","message":"Customer request triaged","service":"agents-service","category":"general","priority":"medium","escalation":false}
{"timestamp":"2025-07-11 12:24:35","level":"info","message":"Customer request triaged","service":"agents-service","category":"general","priority":"medium","escalation":true}
{"timestamp":"2025-07-11 12:24:35","level":"info","message":"Customer request triaged","service":"agents-service","category":"technical","priority":"medium","escalation":false}
{"timestamp":"2025-07-11 12:24:35","level":"info","message":"Customer request triaged","service":"agents-service","category":"general","priority":"medium","escalation":true}
{"timestamp":"2025-07-11 12:24:35","level":"info","message":"Customer request triaged","service":"agents-service","category":"general","priority":"high","escalation":true}
{"timestamp":"2025-07-11 12:24:35","level":"info","message":"Customer request triaged","service":"agents-service","category":"account","priority":"low","escalation":false}
{"timestamp":"2025-07-11 12:24:35","level":"info","message":"Prisma connected successfully","service":"agents-service"}
{"timestamp":"2025-07-11 12:24:35","level":"info","message":"Agent created:","service":"agents-service","agentId":"48c140a9-f1ec-4641-985f-bdf5401a8869","name":"Test Customer Service Agent","type":"CUSTOMER_SERVICE","createdBy":"test-user"}
{"timestamp":"2025-07-11 12:24:35","level":"info","message":"Agent activated:","service":"agents-service","agentId":"48c140a9-f1ec-4641-985f-bdf5401a8869"}
{"timestamp":"2025-07-11 12:24:35","level":"info","message":"Processing orchestration request:","service":"agents-service","agentId":"48c140a9-f1ec-4641-985f-bdf5401a8869","messageLength":32}
{"timestamp":"2025-07-11 12:24:35","level":"error","message":"Error processing orchestration request: \nInvalid `this.prismaClient.agentSession.create()` invocation in\n/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentOrchestratorService.ts:327:61\n\n  324 }\n  325 \n  326 // Создаем новую сессию\n→ 327 const newSession = await this.prismaClient.agentSession.create({\n        data: {\n          agentId: \"48c140a9-f1ec-4641-985f-bdf5401a8869\",\n          status: \"ACTIVE\",\n          context: \"{\\\"userType\\\":\\\"customer\\\",\\\"priority\\\":\\\"normal\\\"}\",\n          metadata: \"{\\\"createdBy\\\":\\\"orchestrator\\\",\\\"startTime\\\":\\\"2025-07-11T09:24:35.939Z\\\"}\",\n      +   userId: String\n        }\n      })\n\nArgument `userId` is missing.","stack":"PrismaClientValidationError: \nInvalid `this.prismaClient.agentSession.create()` invocation in\n/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentOrchestratorService.ts:327:61\n\n  324 }\n  325 \n  326 // Создаем новую сессию\n→ 327 const newSession = await this.prismaClient.agentSession.create({\n        data: {\n          agentId: \"48c140a9-f1ec-4641-985f-bdf5401a8869\",\n          status: \"ACTIVE\",\n          context: \"{\\\"userType\\\":\\\"customer\\\",\\\"priority\\\":\\\"normal\\\"}\",\n          metadata: \"{\\\"createdBy\\\":\\\"orchestrator\\\",\\\"startTime\\\":\\\"2025-07-11T09:24:35.939Z\\\"}\",\n      +   userId: String\n        }\n      })\n\nArgument `userId` is missing.\n    at wn (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/node_modules/@prisma/client/runtime/library.js:29:1363)\n    at $n.handleRequestError (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/node_modules/@prisma/client/runtime/library.js:121:6958)\n    at $n.handleAndLogRequestError (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/node_modules/@prisma/client/runtime/library.js:121:6623)\n    at $n.request (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/node_modules/@prisma/client/runtime/library.js:121:6307)\n    at l (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/node_modules/@prisma/client/runtime/library.js:130:9633)\n    at AgentOrchestratorService.getOrCreateSession (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentOrchestratorService.ts:327:24)\n    at AgentOrchestratorService.processMessage (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentOrchestratorService.ts:77:23)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/e2e/orchestration.e2e.test.ts:78:24\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/index.js:533:5\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/index.js:1056:11)","service":"agents-service","name":"PrismaClientValidationError","clientVersion":"5.22.0"}
{"timestamp":"2025-07-11 12:24:35","level":"info","message":"Agent created:","service":"agents-service","agentId":"580965f5-3bce-4557-9679-32c7c0dc1532","name":"Test Customer Service Agent","type":"CUSTOMER_SERVICE","createdBy":"test-user"}
{"timestamp":"2025-07-11 12:24:35","level":"info","message":"Agent activated:","service":"agents-service","agentId":"580965f5-3bce-4557-9679-32c7c0dc1532"}
{"timestamp":"2025-07-11 12:24:35","level":"info","message":"Processing orchestration request:","service":"agents-service","agentId":"580965f5-3bce-4557-9679-32c7c0dc1532","messageLength":22}
{"timestamp":"2025-07-11 12:24:35","level":"error","message":"Error processing orchestration request: \nInvalid `this.prismaClient.agentSession.create()` invocation in\n/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentOrchestratorService.ts:327:61\n\n  324 }\n  325 \n  326 // Создаем новую сессию\n→ 327 const newSession = await this.prismaClient.agentSession.create({\n        data: {\n          agentId: \"580965f5-3bce-4557-9679-32c7c0dc1532\",\n          status: \"ACTIVE\",\n          context: \"{}\",\n          metadata: \"{\\\"createdBy\\\":\\\"orchestrator\\\",\\\"startTime\\\":\\\"2025-07-11T09:24:35.981Z\\\"}\",\n      +   userId: String\n        }\n      })\n\nArgument `userId` is missing.","stack":"PrismaClientValidationError: \nInvalid `this.prismaClient.agentSession.create()` invocation in\n/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentOrchestratorService.ts:327:61\n\n  324 }\n  325 \n  326 // Создаем новую сессию\n→ 327 const newSession = await this.prismaClient.agentSession.create({\n        data: {\n          agentId: \"580965f5-3bce-4557-9679-32c7c0dc1532\",\n          status: \"ACTIVE\",\n          context: \"{}\",\n          metadata: \"{\\\"createdBy\\\":\\\"orchestrator\\\",\\\"startTime\\\":\\\"2025-07-11T09:24:35.981Z\\\"}\",\n      +   userId: String\n        }\n      })\n\nArgument `userId` is missing.\n    at wn (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/node_modules/@prisma/client/runtime/library.js:29:1363)\n    at $n.handleRequestError (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/node_modules/@prisma/client/runtime/library.js:121:6958)\n    at $n.handleAndLogRequestError (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/node_modules/@prisma/client/runtime/library.js:121:6623)\n    at $n.request (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/node_modules/@prisma/client/runtime/library.js:121:6307)\n    at l (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/node_modules/@prisma/client/runtime/library.js:130:9633)\n    at AgentOrchestratorService.getOrCreateSession (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentOrchestratorService.ts:327:24)\n    at AgentOrchestratorService.processMessage (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentOrchestratorService.ts:77:23)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/e2e/orchestration.e2e.test.ts:97:29\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/index.js:533:5\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/index.js:1056:11)","service":"agents-service","name":"PrismaClientValidationError","clientVersion":"5.22.0"}
{"timestamp":"2025-07-11 12:24:35","level":"info","message":"Agent created:","service":"agents-service","agentId":"6a9d3730-12f6-45d2-aca8-e78039ec4dba","name":"Test Customer Service Agent","type":"CUSTOMER_SERVICE","createdBy":"test-user"}
{"timestamp":"2025-07-11 12:24:35","level":"info","message":"Agent activated:","service":"agents-service","agentId":"6a9d3730-12f6-45d2-aca8-e78039ec4dba"}
{"timestamp":"2025-07-11 12:24:36","level":"info","message":"Agent created:","service":"agents-service","agentId":"96731c6f-497c-457b-8bf9-1ff31fc6eaa8","name":"Test Customer Service Agent","type":"CUSTOMER_SERVICE","createdBy":"test-user"}
{"timestamp":"2025-07-11 12:24:36","level":"info","message":"Agent activated:","service":"agents-service","agentId":"96731c6f-497c-457b-8bf9-1ff31fc6eaa8"}
{"timestamp":"2025-07-11 12:24:36","level":"info","message":"Agent created:","service":"agents-service","agentId":"fda23844-9592-4119-924e-84b0eafa16cb","name":"Booking Agent","type":"BOOKING","createdBy":"test-user"}
{"timestamp":"2025-07-11 12:24:36","level":"info","message":"Agent activated:","service":"agents-service","agentId":"fda23844-9592-4119-924e-84b0eafa16cb"}
{"timestamp":"2025-07-11 12:24:36","level":"info","message":"Agent created:","service":"agents-service","agentId":"ef44f802-477f-49c6-a717-164d43f038cb","name":"Test Customer Service Agent","type":"CUSTOMER_SERVICE","createdBy":"test-user"}
{"timestamp":"2025-07-11 12:24:36","level":"info","message":"Agent activated:","service":"agents-service","agentId":"ef44f802-477f-49c6-a717-164d43f038cb"}
{"timestamp":"2025-07-11 12:24:36","level":"info","message":"Agent created:","service":"agents-service","agentId":"1be1f5ba-c376-4ad2-a541-77cde63063ca","name":"FAQ Agent","type":"FAQ","createdBy":"test-user"}
{"timestamp":"2025-07-11 12:24:36","level":"info","message":"Agent activated:","service":"agents-service","agentId":"1be1f5ba-c376-4ad2-a541-77cde63063ca"}
{"timestamp":"2025-07-11 12:24:36","level":"info","message":"Agent created:","service":"agents-service","agentId":"5c3b1782-ca0d-414e-8e1b-f8c5cee72593","name":"Test Customer Service Agent","type":"CUSTOMER_SERVICE","createdBy":"test-user"}
{"timestamp":"2025-07-11 12:24:36","level":"info","message":"Agent activated:","service":"agents-service","agentId":"5c3b1782-ca0d-414e-8e1b-f8c5cee72593"}
{"timestamp":"2025-07-11 12:24:36","level":"info","message":"Processing orchestration request:","service":"agents-service","agentId":"5c3b1782-ca0d-414e-8e1b-f8c5cee72593","messageLength":22}
{"timestamp":"2025-07-11 12:24:36","level":"error","message":"Error processing orchestration request: \nInvalid `this.prismaClient.agentSession.create()` invocation in\n/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentOrchestratorService.ts:327:61\n\n  324 }\n  325 \n  326 // Создаем новую сессию\n→ 327 const newSession = await this.prismaClient.agentSession.create({\n        data: {\n          agentId: \"5c3b1782-ca0d-414e-8e1b-f8c5cee72593\",\n          status: \"ACTIVE\",\n          context: \"{}\",\n          metadata: \"{\\\"createdBy\\\":\\\"orchestrator\\\",\\\"startTime\\\":\\\"2025-07-11T09:24:36.055Z\\\"}\",\n      +   userId: String\n        }\n      })\n\nArgument `userId` is missing.","stack":"PrismaClientValidationError: \nInvalid `this.prismaClient.agentSession.create()` invocation in\n/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentOrchestratorService.ts:327:61\n\n  324 }\n  325 \n  326 // Создаем новую сессию\n→ 327 const newSession = await this.prismaClient.agentSession.create({\n        data: {\n          agentId: \"5c3b1782-ca0d-414e-8e1b-f8c5cee72593\",\n          status: \"ACTIVE\",\n          context: \"{}\",\n          metadata: \"{\\\"createdBy\\\":\\\"orchestrator\\\",\\\"startTime\\\":\\\"2025-07-11T09:24:36.055Z\\\"}\",\n      +   userId: String\n        }\n      })\n\nArgument `userId` is missing.\n    at wn (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/node_modules/@prisma/client/runtime/library.js:29:1363)\n    at $n.handleRequestError (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/node_modules/@prisma/client/runtime/library.js:121:6958)\n    at $n.handleAndLogRequestError (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/node_modules/@prisma/client/runtime/library.js:121:6623)\n    at $n.request (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/node_modules/@prisma/client/runtime/library.js:121:6307)\n    at l (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/node_modules/@prisma/client/runtime/library.js:130:9633)\n    at AgentOrchestratorService.getOrCreateSession (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentOrchestratorService.ts:327:24)\n    at AgentOrchestratorService.processMessage (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentOrchestratorService.ts:77:23)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/e2e/orchestration.e2e.test.ts:213:24\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/index.js:533:5\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/index.js:1056:11)","service":"agents-service","name":"PrismaClientValidationError","clientVersion":"5.22.0"}
{"timestamp":"2025-07-11 12:24:36","level":"info","message":"Agent created:","service":"agents-service","agentId":"639de9d5-b825-4498-9eda-77266c8d8c12","name":"Test Customer Service Agent","type":"CUSTOMER_SERVICE","createdBy":"test-user"}
{"timestamp":"2025-07-11 12:24:36","level":"info","message":"Agent activated:","service":"agents-service","agentId":"639de9d5-b825-4498-9eda-77266c8d8c12"}
{"timestamp":"2025-07-11 12:24:36","level":"info","message":"Processing orchestration request:","service":"agents-service","sessionId":"11ea1e90-72a9-48d4-8955-77134bdd24cf","agentId":"639de9d5-b825-4498-9eda-77266c8d8c12","messageLength":25}
{"timestamp":"2025-07-11 12:24:36","level":"error","message":"Error processing orchestration request: \nInvalid `this.prismaClient.agentSession.update()` invocation in\n/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentOrchestratorService.ts:372:42\n\n  369     metadata?: Record<string, unknown>;\n  370   },\n  371 ): Promise<void> {\n→ 372   await this.prismaClient.agentSession.update({\n          where: {\n            id: \"11ea1e90-72a9-48d4-8955-77134bdd24cf\"\n          },\n          data: {\n            context: {\n              lastActivity: \"2025-07-11T09:24:36.099Z\",\n              ~~~~~~~~~~~~\n        ?     set?: String\n            }\n          }\n        })\n\nUnknown argument `lastActivity`. Available options are marked with ?.","stack":"PrismaClientValidationError: \nInvalid `this.prismaClient.agentSession.update()` invocation in\n/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentOrchestratorService.ts:372:42\n\n  369     metadata?: Record<string, unknown>;\n  370   },\n  371 ): Promise<void> {\n→ 372   await this.prismaClient.agentSession.update({\n          where: {\n            id: \"11ea1e90-72a9-48d4-8955-77134bdd24cf\"\n          },\n          data: {\n            context: {\n              lastActivity: \"2025-07-11T09:24:36.099Z\",\n              ~~~~~~~~~~~~\n        ?     set?: String\n            }\n          }\n        })\n\nUnknown argument `lastActivity`. Available options are marked with ?.\n    at wn (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/node_modules/@prisma/client/runtime/library.js:29:1363)\n    at $n.handleRequestError (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/node_modules/@prisma/client/runtime/library.js:121:6958)\n    at $n.handleAndLogRequestError (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/node_modules/@prisma/client/runtime/library.js:121:6623)\n    at $n.request (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/node_modules/@prisma/client/runtime/library.js:121:6307)\n    at l (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/node_modules/@prisma/client/runtime/library.js:130:9633)\n    at AgentOrchestratorService.updateSession (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentOrchestratorService.ts:372:5)\n    at AgentOrchestratorService.processMessage (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentOrchestratorService.ts:102:7)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/e2e/orchestration.e2e.test.ts:248:24\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/index.js:533:5\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/index.js:1056:11)","service":"agents-service","name":"PrismaClientValidationError","clientVersion":"5.22.0"}
{"timestamp":"2025-07-11 12:24:36","level":"info","message":"Agent created:","service":"agents-service","agentId":"c1965995-f9be-4d84-a4ff-d2a760b6d132","name":"Test Customer Service Agent","type":"CUSTOMER_SERVICE","createdBy":"test-user"}
{"timestamp":"2025-07-11 12:24:36","level":"info","message":"Agent activated:","service":"agents-service","agentId":"c1965995-f9be-4d84-a4ff-d2a760b6d132"}
{"timestamp":"2025-07-11 12:24:36","level":"info","message":"Processing orchestration request:","service":"agents-service","agentId":"c1965995-f9be-4d84-a4ff-d2a760b6d132","messageLength":20}
{"timestamp":"2025-07-11 12:24:36","level":"error","message":"Error processing orchestration request: \nInvalid `this.prismaClient.agentSession.create()` invocation in\n/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentOrchestratorService.ts:327:61\n\n  324 }\n  325 \n  326 // Создаем новую сессию\n→ 327 const newSession = await this.prismaClient.agentSession.create({\n        data: {\n          agentId: \"c1965995-f9be-4d84-a4ff-d2a760b6d132\",\n          status: \"ACTIVE\",\n          context: \"{}\",\n          metadata: \"{\\\"createdBy\\\":\\\"orchestrator\\\",\\\"startTime\\\":\\\"2025-07-11T09:24:36.125Z\\\"}\",\n      +   userId: String\n        }\n      })\n\nArgument `userId` is missing.","stack":"PrismaClientValidationError: \nInvalid `this.prismaClient.agentSession.create()` invocation in\n/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentOrchestratorService.ts:327:61\n\n  324 }\n  325 \n  326 // Создаем новую сессию\n→ 327 const newSession = await this.prismaClient.agentSession.create({\n        data: {\n          agentId: \"c1965995-f9be-4d84-a4ff-d2a760b6d132\",\n          status: \"ACTIVE\",\n          context: \"{}\",\n          metadata: \"{\\\"createdBy\\\":\\\"orchestrator\\\",\\\"startTime\\\":\\\"2025-07-11T09:24:36.125Z\\\"}\",\n      +   userId: String\n        }\n      })\n\nArgument `userId` is missing.\n    at wn (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/node_modules/@prisma/client/runtime/library.js:29:1363)\n    at $n.handleRequestError (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/node_modules/@prisma/client/runtime/library.js:121:6958)\n    at $n.handleAndLogRequestError (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/node_modules/@prisma/client/runtime/library.js:121:6623)\n    at $n.request (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/node_modules/@prisma/client/runtime/library.js:121:6307)\n    at l (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/node_modules/@prisma/client/runtime/library.js:130:9633)\n    at AgentOrchestratorService.getOrCreateSession (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentOrchestratorService.ts:327:24)\n    at AgentOrchestratorService.processMessage (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentOrchestratorService.ts:77:23)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/e2e/orchestration.e2e.test.ts:263:24\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/index.js:533:5\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/index.js:1056:11)","service":"agents-service","name":"PrismaClientValidationError","clientVersion":"5.22.0"}
{"timestamp":"2025-07-11 12:24:36","level":"info","message":"Agent created:","service":"agents-service","agentId":"62d51142-c10a-4d76-ad81-9894b159ca02","name":"Test Customer Service Agent","type":"CUSTOMER_SERVICE","createdBy":"test-user"}
{"timestamp":"2025-07-11 12:24:36","level":"info","message":"Agent activated:","service":"agents-service","agentId":"62d51142-c10a-4d76-ad81-9894b159ca02"}
{"timestamp":"2025-07-11 12:24:36","level":"info","message":"Agent created:","service":"agents-service","agentId":"4cc63cfd-7878-4f30-8650-84ed05461279","name":"Specialist Agent","type":"CUSTOMER_SERVICE","createdBy":"test-user"}
{"timestamp":"2025-07-11 12:24:36","level":"info","message":"Agent activated:","service":"agents-service","agentId":"4cc63cfd-7878-4f30-8650-84ed05461279"}
{"timestamp":"2025-07-11 12:24:36","level":"info","message":"Processing orchestration request:","service":"agents-service","agentId":"62d51142-c10a-4d76-ad81-9894b159ca02","messageLength":32}
{"timestamp":"2025-07-11 12:24:36","level":"error","message":"Error processing orchestration request: \nInvalid `this.prismaClient.agentSession.create()` invocation in\n/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentOrchestratorService.ts:327:61\n\n  324 }\n  325 \n  326 // Создаем новую сессию\n→ 327 const newSession = await this.prismaClient.agentSession.create({\n        data: {\n          agentId: \"62d51142-c10a-4d76-ad81-9894b159ca02\",\n          status: \"ACTIVE\",\n          context: \"{}\",\n          metadata: \"{\\\"createdBy\\\":\\\"orchestrator\\\",\\\"startTime\\\":\\\"2025-07-11T09:24:36.151Z\\\"}\",\n      +   userId: String\n        }\n      })\n\nArgument `userId` is missing.","stack":"PrismaClientValidationError: \nInvalid `this.prismaClient.agentSession.create()` invocation in\n/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentOrchestratorService.ts:327:61\n\n  324 }\n  325 \n  326 // Создаем новую сессию\n→ 327 const newSession = await this.prismaClient.agentSession.create({\n        data: {\n          agentId: \"62d51142-c10a-4d76-ad81-9894b159ca02\",\n          status: \"ACTIVE\",\n          context: \"{}\",\n          metadata: \"{\\\"createdBy\\\":\\\"orchestrator\\\",\\\"startTime\\\":\\\"2025-07-11T09:24:36.151Z\\\"}\",\n      +   userId: String\n        }\n      })\n\nArgument `userId` is missing.\n    at wn (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/node_modules/@prisma/client/runtime/library.js:29:1363)\n    at $n.handleRequestError (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/node_modules/@prisma/client/runtime/library.js:121:6958)\n    at $n.handleAndLogRequestError (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/node_modules/@prisma/client/runtime/library.js:121:6623)\n    at $n.request (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/node_modules/@prisma/client/runtime/library.js:121:6307)\n    at l (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/node_modules/@prisma/client/runtime/library.js:130:9633)\n    at AgentOrchestratorService.getOrCreateSession (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentOrchestratorService.ts:327:24)\n    at AgentOrchestratorService.processMessage (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentOrchestratorService.ts:77:23)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/e2e/orchestration.e2e.test.ts:304:31\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/index.js:533:5\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/index.js:1056:11)","service":"agents-service","name":"PrismaClientValidationError","clientVersion":"5.22.0"}
{"timestamp":"2025-07-11 12:24:36","level":"info","message":"Agent created:","service":"agents-service","agentId":"967d6394-04af-4fd3-a35e-d50e7c63f52c","name":"Test Customer Service Agent","type":"CUSTOMER_SERVICE","createdBy":"test-user"}
{"timestamp":"2025-07-11 12:24:36","level":"info","message":"Agent activated:","service":"agents-service","agentId":"967d6394-04af-4fd3-a35e-d50e7c63f52c"}
{"timestamp":"2025-07-11 12:24:36","level":"info","message":"Processing orchestration request:","service":"agents-service","agentId":"non-existent-agent-id","messageLength":12}
{"timestamp":"2025-07-11 12:24:36","level":"info","message":"Agent created:","service":"agents-service","agentId":"daba4365-d02f-4220-8b7a-5619e64654e2","name":"Test Customer Service Agent","type":"CUSTOMER_SERVICE","createdBy":"test-user"}
{"timestamp":"2025-07-11 12:24:36","level":"info","message":"Agent activated:","service":"agents-service","agentId":"daba4365-d02f-4220-8b7a-5619e64654e2"}
{"timestamp":"2025-07-11 12:24:36","level":"info","message":"Processing orchestration request:","service":"agents-service","agentId":"daba4365-d02f-4220-8b7a-5619e64654e2","messageLength":0}
{"timestamp":"2025-07-11 12:24:36","level":"error","message":"Error processing orchestration request: \nInvalid `this.prismaClient.agentSession.create()` invocation in\n/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentOrchestratorService.ts:327:61\n\n  324 }\n  325 \n  326 // Создаем новую сессию\n→ 327 const newSession = await this.prismaClient.agentSession.create({\n        data: {\n          agentId: \"daba4365-d02f-4220-8b7a-5619e64654e2\",\n          status: \"ACTIVE\",\n          context: \"{}\",\n          metadata: \"{\\\"createdBy\\\":\\\"orchestrator\\\",\\\"startTime\\\":\\\"2025-07-11T09:24:36.197Z\\\"}\",\n      +   userId: String\n        }\n      })\n\nArgument `userId` is missing.","stack":"PrismaClientValidationError: \nInvalid `this.prismaClient.agentSession.create()` invocation in\n/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentOrchestratorService.ts:327:61\n\n  324 }\n  325 \n  326 // Создаем новую сессию\n→ 327 const newSession = await this.prismaClient.agentSession.create({\n        data: {\n          agentId: \"daba4365-d02f-4220-8b7a-5619e64654e2\",\n          status: \"ACTIVE\",\n          context: \"{}\",\n          metadata: \"{\\\"createdBy\\\":\\\"orchestrator\\\",\\\"startTime\\\":\\\"2025-07-11T09:24:36.197Z\\\"}\",\n      +   userId: String\n        }\n      })\n\nArgument `userId` is missing.\n    at wn (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/node_modules/@prisma/client/runtime/library.js:29:1363)\n    at $n.handleRequestError (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/node_modules/@prisma/client/runtime/library.js:121:6958)\n    at $n.handleAndLogRequestError (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/node_modules/@prisma/client/runtime/library.js:121:6623)\n    at $n.request (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/node_modules/@prisma/client/runtime/library.js:121:6307)\n    at l (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/node_modules/@prisma/client/runtime/library.js:130:9633)\n    at AgentOrchestratorService.getOrCreateSession (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentOrchestratorService.ts:327:24)\n    at AgentOrchestratorService.processMessage (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentOrchestratorService.ts:77:23)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/e2e/orchestration.e2e.test.ts:345:7\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/index.js:533:5\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/index.js:1056:11)","service":"agents-service","name":"PrismaClientValidationError","clientVersion":"5.22.0"}
{"timestamp":"2025-07-11 12:24:36","level":"info","message":"Agent created:","service":"agents-service","agentId":"9a0b7083-ac30-4f28-ad8a-a1e7c8b4bd37","name":"Test Customer Service Agent","type":"CUSTOMER_SERVICE","createdBy":"test-user"}
{"timestamp":"2025-07-11 12:24:36","level":"info","message":"Agent activated:","service":"agents-service","agentId":"9a0b7083-ac30-4f28-ad8a-a1e7c8b4bd37"}
{"timestamp":"2025-07-11 12:24:36","level":"info","message":"Processing orchestration request:","service":"agents-service","sessionId":"non-existent-session","agentId":"9a0b7083-ac30-4f28-ad8a-a1e7c8b4bd37","messageLength":12}
{"timestamp":"2025-07-11 12:24:36","level":"error","message":"Error processing orchestration request: \nInvalid `this.prismaClient.agentSession.create()` invocation in\n/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentOrchestratorService.ts:327:61\n\n  324 }\n  325 \n  326 // Создаем новую сессию\n→ 327 const newSession = await this.prismaClient.agentSession.create({\n        data: {\n          agentId: \"9a0b7083-ac30-4f28-ad8a-a1e7c8b4bd37\",\n          status: \"ACTIVE\",\n          context: \"{}\",\n          metadata: \"{\\\"createdBy\\\":\\\"orchestrator\\\",\\\"startTime\\\":\\\"2025-07-11T09:24:36.213Z\\\"}\",\n      +   userId: String\n        }\n      })\n\nArgument `userId` is missing.","stack":"PrismaClientValidationError: \nInvalid `this.prismaClient.agentSession.create()` invocation in\n/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentOrchestratorService.ts:327:61\n\n  324 }\n  325 \n  326 // Создаем новую сессию\n→ 327 const newSession = await this.prismaClient.agentSession.create({\n        data: {\n          agentId: \"9a0b7083-ac30-4f28-ad8a-a1e7c8b4bd37\",\n          status: \"ACTIVE\",\n          context: \"{}\",\n          metadata: \"{\\\"createdBy\\\":\\\"orchestrator\\\",\\\"startTime\\\":\\\"2025-07-11T09:24:36.213Z\\\"}\",\n      +   userId: String\n        }\n      })\n\nArgument `userId` is missing.\n    at wn (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/node_modules/@prisma/client/runtime/library.js:29:1363)\n    at $n.handleRequestError (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/node_modules/@prisma/client/runtime/library.js:121:6958)\n    at $n.handleAndLogRequestError (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/node_modules/@prisma/client/runtime/library.js:121:6623)\n    at $n.request (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/node_modules/@prisma/client/runtime/library.js:121:6307)\n    at l (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/node_modules/@prisma/client/runtime/library.js:130:9633)\n    at AgentOrchestratorService.getOrCreateSession (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentOrchestratorService.ts:327:24)\n    at AgentOrchestratorService.processMessage (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentOrchestratorService.ts:77:23)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/e2e/orchestration.e2e.test.ts:356:24\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/index.js:533:5\n    at runTest (file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/index.js:1056:11)","service":"agents-service","name":"PrismaClientValidationError","clientVersion":"5.22.0"}
{"timestamp":"2025-07-11 12:24:36","level":"info","message":"Agent created:","service":"agents-service","agentId":"fc647756-5710-4c15-991b-65cef8193444","name":"Test Customer Service Agent","type":"CUSTOMER_SERVICE","createdBy":"test-user"}
{"timestamp":"2025-07-11 12:24:36","level":"info","message":"Agent activated:","service":"agents-service","agentId":"fc647756-5710-4c15-991b-65cef8193444"}
{"timestamp":"2025-07-11 12:24:36","level":"info","message":"Prisma connected successfully","service":"agents-service"}
{"timestamp":"2025-07-11 12:24:36","level":"info","message":"Processing orchestration request:","service":"agents-service","agentId":"fc647756-5710-4c15-991b-65cef8193444","messageLength":20}
{"timestamp":"2025-07-11 12:24:36","level":"info","message":"Processing orchestration request:","service":"agents-service","agentId":"fc647756-5710-4c15-991b-65cef8193444","messageLength":20}
{"timestamp":"2025-07-11 12:24:36","level":"info","message":"Processing orchestration request:","service":"agents-service","agentId":"fc647756-5710-4c15-991b-65cef8193444","messageLength":20}
{"timestamp":"2025-07-11 12:24:36","level":"info","message":"Processing orchestration request:","service":"agents-service","agentId":"fc647756-5710-4c15-991b-65cef8193444","messageLength":20}
{"timestamp":"2025-07-11 12:24:36","level":"info","message":"Processing orchestration request:","service":"agents-service","agentId":"fc647756-5710-4c15-991b-65cef8193444","messageLength":20}
{"timestamp":"2025-07-11 12:24:36","level":"error","message":"Error processing orchestration request: \nInvalid `this.prismaClient.agentSession.create()` invocation in\n/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentOrchestratorService.ts:327:61\n\n  324 }\n  325 \n  326 // Создаем новую сессию\n→ 327 const newSession = await this.prismaClient.agentSession.create({\n        data: {\n          agentId: \"fc647756-5710-4c15-991b-65cef8193444\",\n          status: \"ACTIVE\",\n          context: \"{}\",\n          metadata: \"{\\\"createdBy\\\":\\\"orchestrator\\\",\\\"startTime\\\":\\\"2025-07-11T09:24:36.236Z\\\"}\",\n      +   userId: String\n        }\n      })\n\nArgument `userId` is missing.","stack":"PrismaClientValidationError: \nInvalid `this.prismaClient.agentSession.create()` invocation in\n/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentOrchestratorService.ts:327:61\n\n  324 }\n  325 \n  326 // Создаем новую сессию\n→ 327 const newSession = await this.prismaClient.agentSession.create({\n        data: {\n          agentId: \"fc647756-5710-4c15-991b-65cef8193444\",\n          status: \"ACTIVE\",\n          context: \"{}\",\n          metadata: \"{\\\"createdBy\\\":\\\"orchestrator\\\",\\\"startTime\\\":\\\"2025-07-11T09:24:36.236Z\\\"}\",\n      +   userId: String\n        }\n      })\n\nArgument `userId` is missing.\n    at wn (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/node_modules/@prisma/client/runtime/library.js:29:1363)\n    at $n.handleRequestError (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/node_modules/@prisma/client/runtime/library.js:121:6958)\n    at $n.handleAndLogRequestError (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/node_modules/@prisma/client/runtime/library.js:121:6623)\n    at $n.request (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/node_modules/@prisma/client/runtime/library.js:121:6307)\n    at l (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/node_modules/@prisma/client/runtime/library.js:130:9633)\n    at AgentOrchestratorService.getOrCreateSession (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentOrchestratorService.ts:327:24)\n    at AgentOrchestratorService.processMessage (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentOrchestratorService.ts:77:23)\n    at async Promise.all (index 0)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/__tests__/e2e/orchestration.e2e.test.ts:373:25\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/node_modules/vitest/node_modules/@vitest/runner/dist/index.js:533:5","service":"agents-service","name":"PrismaClientValidationError","clientVersion":"5.22.0"}
{"timestamp":"2025-07-11 12:24:36","level":"error","message":"Error processing orchestration request: \nInvalid `this.prismaClient.agentSession.create()` invocation in\n/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentOrchestratorService.ts:327:61\n\n  324 }\n  325 \n  326 // Создаем новую сессию\n→ 327 const newSession = await this.prismaClient.agentSession.create({\n        data: {\n          agentId: \"fc647756-5710-4c15-991b-65cef8193444\",\n          status: \"ACTIVE\",\n          context: \"{}\",\n          metadata: \"{\\\"createdBy\\\":\\\"orchestrator\\\",\\\"startTime\\\":\\\"2025-07-11T09:24:36.236Z\\\"}\",\n      +   userId: String\n        }\n      })\n\nArgument `userId` is missing.","stack":"PrismaClientValidationError: \nInvalid `this.prismaClient.agentSession.create()` invocation in\n/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentOrchestratorService.ts:327:61\n\n  324 }\n  325 \n  326 // Создаем новую сессию\n→ 327 const newSession = await this.prismaClient.agentSession.create({\n        data: {\n          agentId: \"fc647756-5710-4c15-991b-65cef8193444\",\n          status: \"ACTIVE\",\n          context: \"{}\",\n          metadata: \"{\\\"createdBy\\\":\\\"orchestrator\\\",\\\"startTime\\\":\\\"2025-07-11T09:24:36.236Z\\\"}\",\n      +   userId: String\n        }\n      })\n\nArgument `userId` is missing.\n    at wn (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/node_modules/@prisma/client/runtime/library.js:29:1363)\n    at $n.handleRequestError (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/node_modules/@prisma/client/runtime/library.js:121:6958)\n    at $n.handleAndLogRequestError (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/node_modules/@prisma/client/runtime/library.js:121:6623)\n    at $n.request (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/node_modules/@prisma/client/runtime/library.js:121:6307)\n    at l (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/node_modules/@prisma/client/runtime/library.js:130:9633)\n    at AgentOrchestratorService.getOrCreateSession (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentOrchestratorService.ts:327:24)\n    at AgentOrchestratorService.processMessage (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentOrchestratorService.ts:77:23)\n    at async Promise.all (index 1)","service":"agents-service","name":"PrismaClientValidationError","clientVersion":"5.22.0"}
{"timestamp":"2025-07-11 12:24:36","level":"error","message":"Error processing orchestration request: \nInvalid `this.prismaClient.agentSession.create()` invocation in\n/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentOrchestratorService.ts:327:61\n\n  324 }\n  325 \n  326 // Создаем новую сессию\n→ 327 const newSession = await this.prismaClient.agentSession.create({\n        data: {\n          agentId: \"fc647756-5710-4c15-991b-65cef8193444\",\n          status: \"ACTIVE\",\n          context: \"{}\",\n          metadata: \"{\\\"createdBy\\\":\\\"orchestrator\\\",\\\"startTime\\\":\\\"2025-07-11T09:24:36.236Z\\\"}\",\n      +   userId: String\n        }\n      })\n\nArgument `userId` is missing.","stack":"PrismaClientValidationError: \nInvalid `this.prismaClient.agentSession.create()` invocation in\n/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentOrchestratorService.ts:327:61\n\n  324 }\n  325 \n  326 // Создаем новую сессию\n→ 327 const newSession = await this.prismaClient.agentSession.create({\n        data: {\n          agentId: \"fc647756-5710-4c15-991b-65cef8193444\",\n          status: \"ACTIVE\",\n          context: \"{}\",\n          metadata: \"{\\\"createdBy\\\":\\\"orchestrator\\\",\\\"startTime\\\":\\\"2025-07-11T09:24:36.236Z\\\"}\",\n      +   userId: String\n        }\n      })\n\nArgument `userId` is missing.\n    at wn (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/node_modules/@prisma/client/runtime/library.js:29:1363)\n    at $n.handleRequestError (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/node_modules/@prisma/client/runtime/library.js:121:6958)\n    at $n.handleAndLogRequestError (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/node_modules/@prisma/client/runtime/library.js:121:6623)\n    at $n.request (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/node_modules/@prisma/client/runtime/library.js:121:6307)\n    at l (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/node_modules/@prisma/client/runtime/library.js:130:9633)\n    at AgentOrchestratorService.getOrCreateSession (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentOrchestratorService.ts:327:24)\n    at AgentOrchestratorService.processMessage (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentOrchestratorService.ts:77:23)\n    at async Promise.all (index 2)","service":"agents-service","name":"PrismaClientValidationError","clientVersion":"5.22.0"}
{"timestamp":"2025-07-11 12:24:36","level":"error","message":"Error processing orchestration request: \nInvalid `this.prismaClient.agentSession.create()` invocation in\n/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentOrchestratorService.ts:327:61\n\n  324 }\n  325 \n  326 // Создаем новую сессию\n→ 327 const newSession = await this.prismaClient.agentSession.create({\n        data: {\n          agentId: \"fc647756-5710-4c15-991b-65cef8193444\",\n          status: \"ACTIVE\",\n          context: \"{}\",\n          metadata: \"{\\\"createdBy\\\":\\\"orchestrator\\\",\\\"startTime\\\":\\\"2025-07-11T09:24:36.236Z\\\"}\",\n      +   userId: String\n        }\n      })\n\nArgument `userId` is missing.","stack":"PrismaClientValidationError: \nInvalid `this.prismaClient.agentSession.create()` invocation in\n/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentOrchestratorService.ts:327:61\n\n  324 }\n  325 \n  326 // Создаем новую сессию\n→ 327 const newSession = await this.prismaClient.agentSession.create({\n        data: {\n          agentId: \"fc647756-5710-4c15-991b-65cef8193444\",\n          status: \"ACTIVE\",\n          context: \"{}\",\n          metadata: \"{\\\"createdBy\\\":\\\"orchestrator\\\",\\\"startTime\\\":\\\"2025-07-11T09:24:36.236Z\\\"}\",\n      +   userId: String\n        }\n      })\n\nArgument `userId` is missing.\n    at wn (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/node_modules/@prisma/client/runtime/library.js:29:1363)\n    at $n.handleRequestError (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/node_modules/@prisma/client/runtime/library.js:121:6958)\n    at $n.handleAndLogRequestError (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/node_modules/@prisma/client/runtime/library.js:121:6623)\n    at $n.request (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/node_modules/@prisma/client/runtime/library.js:121:6307)\n    at l (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/node_modules/@prisma/client/runtime/library.js:130:9633)\n    at AgentOrchestratorService.getOrCreateSession (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentOrchestratorService.ts:327:24)\n    at AgentOrchestratorService.processMessage (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentOrchestratorService.ts:77:23)\n    at async Promise.all (index 3)","service":"agents-service","name":"PrismaClientValidationError","clientVersion":"5.22.0"}
{"timestamp":"2025-07-11 12:24:36","level":"error","message":"Error processing orchestration request: \nInvalid `this.prismaClient.agentSession.create()` invocation in\n/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentOrchestratorService.ts:327:61\n\n  324 }\n  325 \n  326 // Создаем новую сессию\n→ 327 const newSession = await this.prismaClient.agentSession.create({\n        data: {\n          agentId: \"fc647756-5710-4c15-991b-65cef8193444\",\n          status: \"ACTIVE\",\n          context: \"{}\",\n          metadata: \"{\\\"createdBy\\\":\\\"orchestrator\\\",\\\"startTime\\\":\\\"2025-07-11T09:24:36.236Z\\\"}\",\n      +   userId: String\n        }\n      })\n\nArgument `userId` is missing.","stack":"PrismaClientValidationError: \nInvalid `this.prismaClient.agentSession.create()` invocation in\n/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentOrchestratorService.ts:327:61\n\n  324 }\n  325 \n  326 // Создаем новую сессию\n→ 327 const newSession = await this.prismaClient.agentSession.create({\n        data: {\n          agentId: \"fc647756-5710-4c15-991b-65cef8193444\",\n          status: \"ACTIVE\",\n          context: \"{}\",\n          metadata: \"{\\\"createdBy\\\":\\\"orchestrator\\\",\\\"startTime\\\":\\\"2025-07-11T09:24:36.236Z\\\"}\",\n      +   userId: String\n        }\n      })\n\nArgument `userId` is missing.\n    at wn (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/node_modules/@prisma/client/runtime/library.js:29:1363)\n    at $n.handleRequestError (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/node_modules/@prisma/client/runtime/library.js:121:6958)\n    at $n.handleAndLogRequestError (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/node_modules/@prisma/client/runtime/library.js:121:6623)\n    at $n.request (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/node_modules/@prisma/client/runtime/library.js:121:6307)\n    at l (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/node_modules/@prisma/client/runtime/library.js:130:9633)\n    at AgentOrchestratorService.getOrCreateSession (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentOrchestratorService.ts:327:24)\n    at AgentOrchestratorService.processMessage (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/services/AgentOrchestratorService.ts:77:23)\n    at async Promise.all (index 4)","service":"agents-service","name":"PrismaClientValidationError","clientVersion":"5.22.0"}
{"timestamp":"2025-07-11 12:24:36","level":"info","message":"Agent created:","service":"agents-service","agentId":"0bc10d4d-40dd-4aff-8eca-38d3a8c3b33b","name":"Test Agent","type":"CUSTOMER_SERVICE","createdBy":"test-user-id"}
{"timestamp":"2025-07-11 12:24:36","level":"info","message":"Prisma disconnected successfully","service":"agents-service"}
{"timestamp":"2025-07-11 12:24:36","level":"info","message":"Agent created:","service":"agents-service","agentId":"ff81e975-1f1e-4e47-9b54-39e5fcdd74f1","name":"Test Agent","type":"FAQ","createdBy":"test-user"}
{"timestamp":"2025-07-11 12:24:36","level":"info","message":"Agent created:","service":"agents-service","agentId":"ca6006e0-b60c-4f48-97c4-5361dab70568","name":"Original Agent","type":"BOOKING","createdBy":"test-user"}
{"timestamp":"2025-07-11 12:24:36","level":"info","message":"Agent updated:","service":"agents-service","agentId":"ca6006e0-b60c-4f48-97c4-5361dab70568"}
{"timestamp":"2025-07-11 12:24:36","level":"info","message":"Agent created:","service":"agents-service","agentId":"18f4733d-8acf-44ce-8ae4-3a3ceb2f09b2","name":"Test Agent","type":"GENERAL","createdBy":"test-user"}
{"timestamp":"2025-07-11 12:24:36","level":"info","message":"Agent activated:","service":"agents-service","agentId":"18f4733d-8acf-44ce-8ae4-3a3ceb2f09b2"}
{"timestamp":"2025-07-11 12:24:36","level":"info","message":"Agent deactivated:","service":"agents-service","agentId":"18f4733d-8acf-44ce-8ae4-3a3ceb2f09b2"}
{"timestamp":"2025-07-11 12:24:36","level":"info","message":"Agent created:","service":"agents-service","agentId":"b4627dd1-d609-4597-8385-273f114fd250","name":"Agent to Delete","type":"TRIAGE","createdBy":"test-user"}
{"timestamp":"2025-07-11 12:24:36","level":"info","message":"Agent deleted:","service":"agents-service","agentId":"b4627dd1-d609-4597-8385-273f114fd250"}
{"timestamp":"2025-07-11 12:24:36","level":"info","message":"Agent created:","service":"agents-service","agentId":"b793a28f-5b61-42f7-a47f-340f9c156bfd","name":"Customer Service Agent","type":"CUSTOMER_SERVICE","createdBy":"test-user"}
{"timestamp":"2025-07-11 12:24:36","level":"info","message":"Agent created:","service":"agents-service","agentId":"822865fd-2198-400b-b976-8a748f696de4","name":"FAQ Agent","type":"FAQ","createdBy":"test-user"}
{"timestamp":"2025-07-11 12:24:36","level":"info","message":"Agent created:","service":"agents-service","agentId":"6683ffe6-94f7-41a6-a2a0-0433a19768df","name":"Agent with Sessions","type":"CUSTOMER_SERVICE","createdBy":"test-user"}
{"timestamp":"2025-07-11 12:24:36","level":"info","message":"Agent created:","service":"agents-service","agentId":"28e896c1-80c6-4911-a21c-b6a533ab4bce","name":"Versioned Agent","type":"CUSTOMER_SERVICE","createdBy":"test-user"}
{"timestamp":"2025-07-11 12:24:36","level":"info","message":"Agent created:","service":"agents-service","agentId":"27de006b-af5a-4a85-afdd-16d2a383bdc2","name":"Multi Version Agent","type":"FAQ","createdBy":"test-user"}
{"timestamp":"2025-07-11 12:24:36","level":"info","message":"Prisma disconnected successfully","service":"agents-service"}
{"timestamp":"2025-07-11 12:24:37","level":"info","message":"Agent created:","service":"agents-service","agentId":"agent-1","name":"Test Agent","type":"CUSTOMER_SERVICE","createdBy":"user-1"}
{"timestamp":"2025-07-11 12:24:37","level":"info","message":"Agent deleted:","service":"agents-service","agentId":"agent-1"}
{"timestamp":"2025-07-11 12:24:37","level":"info","message":"Agent activated:","service":"agents-service","agentId":"agent-1"}
{"level":"info","message":"Partner registered","partnerId":"partner_1752225877498_toq5023u5","referralCode":"BILINGUSDXNLCIMCYM1O1M","service":"bilingus-service","timestamp":"2025-07-11T09:24:37.498Z","userId":"user-1"}
{"level":"info","message":"Referral added","partnerId":"user-1","referralId":"partner_1752225877501_eijnoh90o","referredUserId":"user-2","service":"bilingus-service","timestamp":"2025-07-11T09:24:37.501Z"}
{"amount":100,"currency":"RUB","level":"info","message":"Payout completed","partnerId":"test-partner-id","payoutId":"partner_1752225877502_986ir0rbl","service":"bilingus-service","timestamp":"2025-07-11T09:24:37.502Z"}
{"level":"info","message":"Partner registered","partnerId":"partner_1752225877503_2whorz1m6","referralCode":"BILINGUSDXNLCIMCYM1O1R","service":"bilingus-service","timestamp":"2025-07-11T09:24:37.503Z","userId":"user-1"}
{"error":{},"level":"error","message":"Failed to register partner","service":"bilingus-service","timestamp":"2025-07-11T09:24:37.504Z","userId":"non-existent-user"}
{"amount":0,"currency":"RUB","error":{},"level":"error","message":"Failed to process payout","partnerId":"partner-1","service":"bilingus-service","timestamp":"2025-07-11T09:24:37.505Z"}
{"timestamp":"2025-07-11 12:24:38","level":"info","message":"OpenAI Service initialized","service":"agents-service"}
{"timestamp":"2025-07-11 12:24:38","level":"info","message":"OpenAI Service initialized","service":"agents-service"}
{"timestamp":"2025-07-11 12:24:38","level":"info","message":"Request started","traceId":"ffa4e990-3fa1-4f22-99f8-9d72117ff649","service":"agents-service","method":"GET","url":"/health","ip":"::ffff:127.0.0.1"}
{"timestamp":"2025-07-11 12:24:38","level":"info","message":"Request completed","traceId":"ffa4e990-3fa1-4f22-99f8-9d72117ff649","service":"agents-service","method":"GET","url":"/health","statusCode":200,"duration":5,"hrDuration":"5.04ms","responseSize":268,"ip":"::ffff:127.0.0.1"}
{"timestamp":"2025-07-11 12:24:38","level":"info","message":"Request started","traceId":"e1e0a378-165c-4eca-8cae-1b430276b79c","service":"agents-service","method":"GET","url":"/info","ip":"::ffff:127.0.0.1"}
{"timestamp":"2025-07-11 12:24:38","level":"info","message":"Request completed","traceId":"e1e0a378-165c-4eca-8cae-1b430276b79c","service":"agents-service","method":"GET","url":"/info","statusCode":200,"duration":2,"hrDuration":"1.38ms","responseSize":702,"ip":"::ffff:127.0.0.1"}
{"timestamp":"2025-07-11 12:24:38","level":"info","message":"Request started","traceId":"658aea31-e370-4538-aee5-5a68d6fd9525","service":"agents-service","method":"GET","url":"/agents","ip":"::ffff:127.0.0.1"}
{"timestamp":"2025-07-11 12:24:38","level":"info","message":"Request completed","traceId":"658aea31-e370-4538-aee5-5a68d6fd9525","service":"agents-service","method":"GET","url":"/agents","statusCode":200,"duration":1,"hrDuration":"1.16ms","responseSize":89,"ip":"::ffff:127.0.0.1"}
{"timestamp":"2025-07-11 12:24:38","level":"info","message":"Request started","traceId":"cc2350de-3200-40b7-986d-270fe3abd7fb","service":"agents-service","method":"GET","url":"/non-existent-route","ip":"::ffff:127.0.0.1"}
{"timestamp":"2025-07-11 12:24:38","level":"error","message":"Error occurred","traceId":"unknown","stack":"ApiError: Route GET /non-existent-route not found\n    at Function.notFound (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/utils/ApiError.ts:37:12)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/src/app.ts:182:19\n    at Layer.handle [as handle_request] (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/node_modules/express/lib/router/index.js:328:13)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/node_modules/express/lib/router/index.js:286:9\n    at param (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/node_modules/express/lib/router/index.js:365:14)\n    at param (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/node_modules/express/lib/router/index.js:376:14)\n    at Function.process_params (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/node_modules/express/lib/router/index.js:421:3)\n    at next (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/node_modules/express/lib/router/index.js:280:10)\n    at file:///Users/dmitriy/Google%20%D0%94%D0%B8%D1%81%D0%BA/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B%20%D0%BA%D1%83%D1%80%D1%81%D0%BE%D1%80/Hubus/services/agents-service/node_modules/express-rate-limit/dist/index.mjs:779:7","service":"agents-service","error":"Route GET /non-existent-route not found","url":"/non-existent-route","method":"GET","body":{},"params":{},"query":{}}
{"timestamp":"2025-07-11 12:24:38","level":"warn","message":"Request completed","traceId":"cc2350de-3200-40b7-986d-270fe3abd7fb","service":"agents-service","method":"GET","url":"/non-existent-route","statusCode":404,"duration":1,"hrDuration":"1.56ms","responseSize":183,"ip":"::ffff:127.0.0.1"}
{"timestamp":"2025-07-11 12:24:38","level":"error","message":"Error occurred","traceId":"unknown","stack":"SyntaxError: Unexpected token 'j', \"{\"invalid\": json}\" is not valid JSON\n    at JSON.parse (<anonymous>)\n    at parse (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/node_modules/body-parser/lib/types/json.js:92:19)\n    at /Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/node_modules/body-parser/lib/read.js:128:18\n    at AsyncResource.runInAsyncScope (node:async_hooks:206:9)\n    at invokeCallback (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/node_modules/raw-body/index.js:238:16)\n    at done (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/node_modules/raw-body/index.js:227:7)\n    at IncomingMessage.onEnd (/Users/dmitriy/Google Диск/Проекты курсор/Hubus/services/agents-service/node_modules/raw-body/index.js:287:7)\n    at IncomingMessage.emit (node:events:524:28)\n    at endReadableNT (node:internal/streams/readable:1698:12)\n    at processTicksAndRejections (node:internal/process/task_queues:82:21)","service":"agents-service","error":"Unexpected token 'j', \"{\"invalid\": json}\" is not valid JSON","url":"/agents","method":"POST","body":{},"params":{},"query":{}}
